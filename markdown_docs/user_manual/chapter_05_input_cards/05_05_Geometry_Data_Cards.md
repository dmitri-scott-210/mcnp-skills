---
title: "Chapter 5.5 - Geometry-focused Data Cards"
chapter: "5.5"
source_pdf: "mcnp631_theory_user-manual/mcnp-user-manual-chapters/5_Input_Cards/5.5_Geometry-focused_Data_Cards.pdf"
conversion_date: "2025-10-30"
converted_by: "Docling MCP Server + Claude"
notes: "Converted from MCNP6.3.1 documentation"
---

<!-- image -->

99

```
1 3 0 -1.2 -1.1 1.4 -1.5 -1.6 99 2 4 0 1.1 -2001.1 -5.3 -5.5 -5.6 -5.4 3 5 0 -5 4 1 0 -1 5 2 like 1 but trcl = (2 0 0) 6 9 0 (-5.1:1.3:2001.1:-99:5.5:5.6) #5 7 8 5 rpp -2 0 -2 0 -1 1 9 1 rpp 0 2 0 2 -1 1 10 99 py -2
```

Figure 5.4: Macrobody Geometry Example

Alternative descriptions for cell 3:

```
1 3 0 5.1 -1.1 -5.3 -5.5 -5.6 99 2 3 0 5.1 -1.1 1.4 -5.5 -5.6 -5.4 3 3 0 -1.2 -1.1 -5.3 -5.5 -5.6 -5.4
```

## 5.4 Data Card Introduction

All MCNP6 input cards other than those for cells [§5.2] and surfaces
[§5.3] are entered after the blank card delimiter following the surface
card block. The card name must begin within the first five columns.

Only the cards listed in §4.3 are allowed in a restart-calculation input
file. No data card can be used more than once with the same number or
particle type designations. For example, M1 and M2 are acceptable, as
are CUT:N and CUT:P , but two M1 cards or two CUT:N cards are
disallowed. Note that when data cards accept keyword-value pairs, the
equals sign ( = ) between the keyword and the value is optional.

## 5.5 Geometry-focused Data Cards

## 5.5.1 VOL: Cell Volume

Volumes or masses of cells are required for some tallies. MCNP6
calculates the volumes of all cells that are rotationally symmetric
(generated by surfaces of revolution) about any axis, even a skew axis.
It will also

calculate the volumes of polyhedral cells. As a by-product of the volume
calculation, areas and masses are also calculated. These volumes, areas,
and masses can be printed in the MCNP output file by using the PRINT
card. The user can enter values on the VOL card for the volume of any
cell and these values, instead of the calculated values, will be used
for tally purposes. If a cell volume required for a tally cannot be
calculated and is not entered on the VOL or SDn cards, a fatal error
message is printed.

```
Cell-card Form: VOL x or Data-card Form: VOL [ NO ] x1 x2 . . . xJ x Volume of cell. xj Volume of cell j where j = 1 , 2 , ..., J where J is equal to the number of cells in the problem ( 1 ). NO Optional, no volumes or areas are calculated ( 2 ).
```

Default: Use MCNP6-calculated volumes. MCNP6 attempts to calculate the
volume of all cells unless the NO keyword appears on the VOL card.

Use: Use if required cell volumes are not properly calculated. Provides
an alternative way to enter volumes required by tallies. Normally the SD
n card is used. The VOL card can be used only for cell volumes; the SD n
card can be used for cell and segment volumes or masses.

## Details:

- 1 If the number of entries does not equal the number of cells in the problem, it is a fatal error. Use the jump ( n J ) feature to skip over cells for which you do not want to enter values.
- 2 When the NO entry appears on the VOL card, MCNP6 bypasses the volume calculation altogether. The xj entries following NO are optional. If present, xj entries are the volume values the code will use. If no value is entered for a cell on the VOL card, the calculated volume is used.

## 5.5.1.1 Stochastic Volume and Area Calculation

MCNP6 cannot calculate the volumes and areas of asymmetric, non-
polyhedral, or infinite cells. Also, in some cases, the volume and area
calculation can fail because of round-off errors. For these cases, when
neither MCNP6 nor the user can calculate the volume or area, a
stochastic estimation is possible by ray tracing. The procedure follows:

1. Void out all materials in the problem by inserting a VOID card into the data card portion of the input.
2. Set all nonzero importance to one and all positive weight windows to zero.
3. Use a planar source with a source weight equal to the surface area to flood the geometry with particles. This setup will cause the particle flux throughout the geometry to statistically approach unity.
4. (a) Alternatively, it has been suggested that the best way to do a stochastic volume estimation is to use an inward-directed, biased cosine source on a spherical surface with weight equal to πr 2 [179], where this weight scales the track-length tally to convert it from a mean chord length estimate to a volume estimate.

4. Use the track-length tally ( F4 ) to estimate volumes and the surface flux tally ( F2 ) to estimate areas. The cell flux tally is inversely proportional to cell volume. Thus in cells whose volumes are known, the unit flux will result in a tally of unity and, in cells whose volumes are uncalculated, the unit flux will result in a tally of volumes. Similarly, the surface flux tally is inversely proportional to area so that the unit flux will result in a tally of unity wherever the area is known and a tally of area wherever it is unknown.
5. For any tally volume or area that MCNP6 cannot calculate, use the AREA , VOL , or SD card to assign a value of 1.0 to the area(s) and/or volume(s) of the surface(s) or cell(s) of interest.

An example of a stochastic volume calculation is given in Listing 5.13
where the FC cards indicate the expected values and the TF cards are
used to ensure that TFC values correspond to the volume indicated in the
FC card.

```
1 sdef sur = 400 nrm = -1 dir = d1 wgt = 30790.7495978336 $ wgt = pi * (r = 99) ** 2 2 si1 0 1 3 sp1 -21 1 4 sb1 -21 2 5 c 6 c This block of tallies demonstrates stochastic volume sampling. 7 c 8 fc114 Hexagon: 6928 cm^3 9 fc124 Cylinder: 39270 cm^3 10 fc134 Cylinder -Two Hexagons: 25414 cm^3 11 fc144 Box: 216000 cm^3 12 fc154 Box - Cylinder: 176730 cm^3 13 fc164 Inner Sphere: 4064379 cm^3 14 fc174 Inner Sphere -Two Boxes: 3632379 cm^3 15 c 16 f114:n (1000 < 2000 < 3000) (1100 < 2000 < 3000) 17 f124:n ((1000 1100 1200) < 2000 < 3000) 18 f134:n (1200 < 2000 < 3000) 19 f144:n ((1000 1100 1200) < 2000 < 3000) (2100 < 3000) t 20 f154:n (2100 < 3000) 21 f164:n ((1000 1100 1200) < 2000 < 3000) ((1000 1100 1200) < 2000 < 3100) 22 (2100 < 3000) (2100 < 3100) 4000 t 23 f174:n 4000 24 c 25 sd114 1 1 26 sd124 1 27 sd134 1 28 sd144 1 1 1 29 sd154 1 30 sd164 1 1 1 1 1 1 31 sd174 1 32 c 33 tf144 3 7j $ f d u s m c e t 34 tf164 6 7j $ f d u s m c e t
```

Listing 5.13: example\_tally\_universe\_expansion\_stochastic\_volume.mcnp.inp.txt

## 5.5.2 AREA: Surface Area

MCNP6 calculates the area of surfaces as a by-product of the volume
calculation. If the volume of all cells on either side of the surface
can be calculated, the area of the surface will be calculated.
Otherwise, the area calculation will fail.

## Data-card Form: AREA x1 x2 . . . xJ

xj

Area of surface j where j = 1 , 2 , ..., J where J is equal to the
number of cells in the problem ( 1 , 2 ).

Default: MCNP6 attempts to calculate the area of all surfaces.

Use: Use if required surface areas for F2 tallies are not properly
calculated. Provides an alternative way to enter areas required by
tallies. Normally the SD n card is used. The AREA card can be used only
for areas of whole surfaces; the SD n card can be used for area of
surface segments as well as whole surfaces.

## Details:

- 1 If the number of entries does not equal the number of surfaces in the problem, it is a fatal error. Use the jump ( n J ) feature to skip over surfaces for which you do not want to enter values.
- 2 If no value is entered for a surface on the AREA card, the calculated area, if any, is used. A fatal error occurs if an area is required for tallying purposes and is not available either from the MCNP6 calculation or from and AREA or SD n card.

## 5.5.3 TR: Coordinate Transformation

Coordinate transformations in MCNP6 can be used to simplify the
geometric description of surfaces. They also may be used to relate the
coordinate system of a surface source problem to the coordinate system
of the problem that wrote the surface source file and to position
universes within container cells. See the surface source SSR card or
universe U card. Periodic boundary surfaces cannot have surface
transformations.

To use a transformation to simplify the description of a surface, choose
an auxiliary coordinate system in which the description of the surface
is easy, include a transformation number n on the surface card, and
specify the transformation on a TR n card. See Section 10.1.2 for an
example showing how much easier it is to specify a skewed cylinder this
way than as a GQ surface. Often a whole cluster of cells will have a
common natural coordinate system. All of their surfaces can be described
in that system and then translated and/or rotated to a new system by a
single TR n card.

## Data-card Form: TR n o1 o2 o3 xx' yx' zx' xy' yy' zy' xz' yz' zz' m

- n

Number assigned to the transformation.

Restriction:

1 ≤ n ≤ 999 for surface transformations; no limit for cell
transformations using TRCL = n

o1 o2 o3

Displacement vector of the transformation. DEFAULT: (0 , 0 , 0)

The default rotation matrix is

See also 1 , 2 , 5 .

<!-- formula-not-decoded -->

| m   | Displacement vector origin   | Displacement vector origin                                                                                                      |
|-----|------------------------------|---------------------------------------------------------------------------------------------------------------------------------|
|     | m = 1                        | the displacement vector is the location of the origin of the auxiliary coordinate system, defined in the main system. (DEFAULT) |
|     | m = - 1                      | the displacement vector is the location of the origin of the main coordinate system, defined in the auxiliary system.           |

Default:

TR n 0 0 0 1 0 0 0 1 0 0 0 1 1

Use: Optional. Convenient for many geometries. TR cards used in a
surface definition must have numbers 1 ≤ n ≤ 999 . TR card used for cell
transformations via TRCL = n can have any number.

Reminder: When a transformation is applied to a cell, MCNP6 generates a
set of new unique surface numbers based on the original surface numbers.
The number of the generated surface is equal to the number of original
surface plus 1000 times the number of the cell. This formula creates
generated surface numbers that are predictable and can be used on other
cell cards and on tally cards. This method, however, limits cell numbers
to no more than 6 digits and the original surface numbers to no more
than 3 digits.

## Details:

- 1 If the symbol * TR is used, the rotation matrix entries are angles in degrees instead of cosines of the angles.
- 2 The rotation matrix entries specify the relationship between the directions of the axes of the two coordinate systems. For example, the value of xx' is the cosine of the angle (or, if the optional asterisk is used, the angle in degrees ranging from 0 ◦ to 180 ◦ ) between the x axis of the main coordinate system and the x ′ axis of the auxiliary coordinate system. Similarly, yx' is the cosine of the angle between the y axis of the main coordinate system and the x ′ axis of the auxiliary system.
- 3 The meaning of the rotation matrix entries do not depend on the value of m . It is usually not necessary to enter all of the elements of the matrix. The following patterns are acceptable:
- (a) All nine elements. Required if one of the systems is right-handed and the other is left-handed.
- (b) Two of the three vectors either way in the matrix (6 values). MCNP6 will create the third vector by cross product.
- (c) One vector each way in the matrix (5 values). The component in common must be less than 1. MCNP6 will fill out the matrix by the Eulerian angles scheme.
- (d) One vector (3 values). MCNP6 will create the other two vectors in some arbitrary way. Appropriate when the auxiliary coordinate system is being used to describe a set of surfaces that are all surfaces of rotation about a common skew axis.
- (e) None. MCNP6 will create the identity matrix. Appropriate when the transformation is a pure translation.
- 4 A vector consists of the three elements in either a row or a column in the matrix. In all cases, MCNP6 cleans up any small non-orthogonality and normalizes the matrix. In this process, exact vectors like (1 , 0 , 0) are left unchanged. A warning message is issued if the non-orthogonality is more than about 0.001 radian.

1

2

- 5 A cone of one sheet can be rotated only from being on or parallel to one coordinate axis to being on or parallel to another coordinate axis (multiples of 90 ◦ ). A cone of one sheet can have any origin displacement vector appropriate to the problem. A cone of two sheets can be transformed anywhere. A cone of two sheets with an ambiguity surface in the cell description to cut the two-sheet cone in half (so that the cell appears as one sheet) can be transformed. The ambiguity surface must have the same transformation number as the cone of two sheets. Ambiguity surfaces are described in §2.2.3.2.

## 5.5.3.1 Example 1

```
17 4 RCC 0 0 0 0 12 0 5 * TR4 20 0 0 45 -45 90 135 45 90 90 90 0
```

In this example, surface 17 is transformed via transformation 4 causing
it to be displaced to ( x, y, z ) = (20 , 0 , 0) and rotated 45 ◦
counter-clockwise with respect to x and y . If the rotational matrix is
left incomplete, MCNP6 will calculate what it should be, but
completeness is the only way to be sure you get what you want and get
error messages if you are wrong.

## 5.5.3.2 Example 2

```
1 11 4 PX 5 2 TR4 7 0.9 1.3 0 1 0 0 0 1 1 0 0
```

Surface 11 is set up in an auxiliary coordinate system that is related
to the main coordinate system by transformation number 4. MCNP6 will
produce coefficients in the main coordinate system as if surface 11 had
been entered as

1

1

11 P 0 -1.0 4.1

It will not produce

11 PY 4.1

This surface, represented by PY as shown in the line above, has the
wrong sense. More examples of the transformation capability appear in
§10.1.2.

## 5.5.4 TRCL: Cell Coordinate Transformation

A cell transformation ( TRCL cell parameter) may be applied to a cell
using either of two formats. The first TRCL entry form is an integer
that is interpreted as the number of a TR n card that contains
transformation information for all of the surfaces defining the cell.
The associated TR n card is located in the data card section of the MCNP
input file. An alternate entry form for TRCL allows the actual
transformation to be entered on the cell card following the TRCL
mnemonic, enclosed by parentheses. If the actual transformation is
entered, all the rules applying to the TR card are valid.

1

1

Although a cell transformation can be applied to a standard cell, the
utility of the TRCL parameter becomes most evident when applied to
repeated structures [§5.5.5]. Assume your analysis model contains
several cells identical in size and shape but located at multiple places
in the geometry. You can describe the surfaces that describe these cells
once and then use the TRCL keyword to position the identical cells in
various locations and/or orientations. The TRCL feature is especially
valuable when these cells are filled with the same universe. If the
surfaces of these filled cells and the surfaces of the cells belonging
to the universe that fills them are all described in the same auxiliary
coordinate system, then a single transformation will completely define
the interior of all these filled cells. That is, the cells of the
universe will inherit the transformation of the cells they fill.

```
Cell-card Form: TRCL = n or Cell-card Form: TRCL = ( o1 o2 o3 xx' yx' zx' xy' yy' zy' xz' yz' zz' m )
```

n

Number of the transformation corresponding to a TR n card in the data
section of the input file. DEFAULT: n = 0

o1 o2 o3

Displacement vector of the transformation. DEFAULT: (0 , 0 , 0)

The default rotation matrix is

See the description of the rotation matrix in §5.5.3, Detail 2 and
§5.5.4, Detail 2 .

<!-- formula-not-decoded -->

- m Displacement vector origin

m

= 1

m = -1

the displacement vector is the location of the origin of the auxiliary
coordinate system, defined in the main system. (DEFAULT)

the displacement vector is the location of the origin of the main
coordinate system, defined in the auxiliary system.

Default: No transformation if TRCL card is absent. This is equivalent to

TRCL=0

or

```
TRCL 0 0 0 1 0 0 0 1 0 0 0 1 1
```

Use: Optional. Convenient for many geometries. Use with the LIKE BUT
cell description. To transform a standard cell description it is
recommended that the TR parameter associated with the surface cards be
used.

## Details:

- 1 Coordinate transformations using TRCL can be applied only to cells with surface numbers &lt; 1000 . When a transformation is applied to a cell, MCNP6 generates a set of new unique surface numbers based on the original surface numbers. The number of the generated surface is equal to the number of the original surface plus 1000 times the number of the cell. This formula creates generated surface numbers that are predictable and can be used on other cell cards and on tally cards. This method, however, limits cell numbers to 6 digits and original surface numbers to no more than three digits. These generated surfaces are only the bounding surfaces of the transformed cell, not the surfaces of any universe that fills it. MCNP6 requires only one full description of each universe, no matter how many times that universe is referenced in the problem
- 2 If the symbol * TRCL is used, the rotation matrix entries are angles in degrees instead of cosines of the angles.
- 3 The displacement vector, o1 o2 o3 , rotation matrix, xx' yx' zx' xy' yy' zy' xz' yz' zz' , and displacement vector origin, m , must be enclosed in parentheses for the second form.

## 5.5.4.1 Example 1

```
1 1 0 -17 $ rcc can 2 21 like 1 but * trcl=(20 0 0 45 -45 90 135 45 90 90 90 0)
```

Cell 21 is like cell 1 but is translated to ( x, y, z ) = (20 , 0 , 0)
and rotated 45 ◦ counter-clockwise with respect to x and y . If the
rotational matrix is left incomplete, MCNP6 will calculate what it
should be, but completeness is the only way to be sure you get what you
want and get error messages if you are wrong.

## 5.5.5 Repeated Structures

The primary goal of the repeated-structures capability is to make it
possible to describe only once the cells and surfaces of any structure
that appears more than once in a geometry. Obvious examples of geometry
models constructed from repeated structures include a reactor core with
dozens of nearly identical fuel modules or a room containing complicated
but nearly identical objects arranged in an irregular order. Although
the repeated-structures feature reduces input and memory use, problems
will not run any faster than with any other description. Examples of the
use of repeated structures cards appear in §10.1.3.

The repeated structures capability extends the concept of an MCNP6 cell.
Four cards are used exclusively to define repeated-structure features of
a geometry: universe ( U ); fill ( FILL ); lattice ( LAT ); and, for
stochastic geometries, URAN . Additionally, the cell transformation
keyword ( TRCL ) is a supportive companion to the repeated-structures
capability and the LIKE n BUT cell-description construct provides a
convenient way to create multiple cells with similar attributes.

The user can specify that a cell is to be filled with something called a
universe. The U card identifies the universe, if any, to which a cell
belongs, and the FILL card specifies with which universe a cell is to be
filled. A universe is either a lattice ( LAT card) or a user-specified
collection of cells. A single universe, described only once, can be
designated to fill each of any number of cells in the geometry. Some or
all of the cells in a universe may themselves be filled with universes.
To use the repeated-structures capability effectively, keep in mind the
following information:

## Details:

- 1 Cell parameters ( IMP , VOL , PWT , EXT , FCL , WWN , DXC , NONU , PD , TMP , U , TRCL , LAT , FILL , ELPT , COSY , BFLCL , and UNC ) can be defined on cell cards.
- 2 LIKE n BUT is a shorthand method to describe easily one cell as equivalent to another except for a limited list of attributes [§5.2].
- 3 The universe ( U ) card specifies to what universe a cell belongs.
- 4 The fill ( FILL ) card specifies with which universe a cell is to be filled.
- 5 The cell transformation ( TRCL ) keyword allows the user to define only once the surfaces that bound several cells identical in size and shape but located at different places in the geometry. The TRCL keyword follows the transformation rules established for the surface transformation ( TR ) card.
- 6 The lattice ( LAT ) card defines an infinite array of hexahedra or hexagonal prisms. Lattice cell indexing is determined by the user-specified order of the surfaces that describe the [0 , 0 , 0] lattice cell.
- 7 A general source description can be defined in a repeated structures part of the geometry. Surface source surfaces must be regular MCNP6 surfaces, not surfaces associated with a repeated structures part of the geometry. No check is made that this requirement is met.
- 8 An importance assigned to a cell that is in a universe is interpreted as a multiplier of the importance of the filled cell. Weight-window lower bounds are not multipliers. Mesh-based weight windows ( MESH card) automatically address this issue.

## 5.5.5.1 U: Universe Keyword

Think of a universe as either a lattice cell or a collection of ordinary
cells that you want to treat in a common manner. For example, perhaps
this collection of cells appears multiple times in your model, but in
varying orientations. You can use the repeated structures capability to
simplify the setup of your model.

By assigning a non-zero universe number to one or more cells, the user
creates a geometry unit that can be manipulated or referenced as a
group. This assignment is accomplished by using the universe ( U ) card
or, equivalently, the U cell-parameter keyword. If a cell lacks a
universe assignment or is assigned to universe zero ( U = 0 ), then the
cell does not belong to any universe and is a member of the real world.
By using the FILL card, a cell can be filled with a collection of cells
that are assigned to the same universe. Note that the cells of a
universe may be geometricly finite or infinite, but they must fill all
of the space inside any cell that the universe is specified to fill.

One way to think about the connection between a filled cell and the
filling universe is that the filled cell is a 'window' that looks into a
second level, like a window in a wall provides a view of the outdoors.
Cells in the second level can be infinite because they will be
(virtually) truncated when they bump into or intersect the surfaces of
the window. The second level can have its own origin, in a primed
coordinate system, unrelated to the upper level origin. However, if the
filled cell and filling universe have all their surfaces in the same
coordinate system, one TRCL parameter defines the coordinate system of
both filled and filling cells.

A cell in a universe can be filled by another universe, in which case a
third level is introduced. Up to 20 levels are permitted, more than most
problems will need. The nomenclature chosen to address these
hierarchical levels uses the following convention: the highest to lowest
level is in inverse order to the associated numerical value. That is,
the highest level is level zero (also known as the real world), lower is
level one, lower still is level two, etc.

1

2

3

4

Every cell in the problem is either part of the real world (universe
level 0) or part of some universe, but the surfaces of a problem are
less restricted. A single planar surface can be used to describe cells
in more than one universe. Coincident surfaces cannot be reflecting or
periodic, source surfaces, or tally surfaces. Materials are normally put
into the cells of the lowest level universe, not in the higher level,
but there is an exception in the case of a lattice.

| Cell-card Form: U = n or Data-card Form: U n1 n2 . . . nJ   | Cell-card Form: U = n or Data-card Form: U n1 n2 . . . nJ                                                                                                                                                                                                                                                                                                       |
|-------------------------------------------------------------|-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|
| n                                                           | Arbitrary universe number (integer) to which cell is assigned. DEFAULT: U = 0 , the 'real world' universe ( 1 ). Restriction: 0 ≤ n ≤ 99 , 999 , 999                                                                                                                                                                                                            |
| nj                                                          | Universe numbers assigned to each cell of the problem in the same order as the cells appear in the cell card section. Note: when provided in the form of a data card, there must be an entry (which can be 0) for each cell in the problem. The jump feature ( n J ) can be used for cells not assigned a universe number. Restriction: 0 ≤ nj ≤ 99 , 999 , 999 |

Default: Lack of a U card or a zero entry means that the cell does not
belong to any universe. Instead the cell is part of what is termed the
'real world.'

Use: Required for repeated structures.

## Details:

- 1 A problem will run faster by preceding the U card entry with a minus sign for any cell that is not truncated by the boundary of any higher-level cell. The minus sign indicates that calculating distances to boundary in higher-level cells can be omitted.

## /warning\_sign Caution

Use this capability with extreme caution. MCNP6 cannot detect errors in
this feature because the logic that enables detection is omitted by the
presence of the negative universe. Extremely wrong answers can be
quietly calculated. Plot several views of the geometry and/or run with
the VOID card to check for errors.

## 5.5.5.1.1 Example 1

Planar surfaces of a filled cell and those in a filling universe can be
coincident as shown in Listing 5.14.

Listing 5.14: example\_universe\_1.mcnp.inp.txt

|   1 | 0 1 -2 -3 4 -5   | 6 fill=1         |
|-----|------------------|------------------|
|   2 | 0 -7 1 -3 8      | u=1 fill=2 lat=1 |
|   3 | 0 -11            | u=-2             |
|   4 | 0 11             | u=2              |

5

6

7

8

9

10

11

12

13

14

15

16

|   5 | 0   | -1:2:3:-4:5:-6   |
|-----|-----|------------------|
|   1 | px  | 0                |
|   2 | px  | 50               |
|   3 | py  | 10               |
|   4 | py  | -10              |
|   5 | pz  | 5                |
|   6 | pz  | -5               |
|   7 | px  | 10               |
|   8 | py  | 0                |
|  10 | py  | 10               |
|  11 | s   | 5 5 0 4          |

In other words, the cells of a universe can fit exactly into the filled
cell. This example illustrates this feature. Represented is a 50 × 20 ×
10 -cm box filled with a lattice of 10 × 10 × 10 -cm cubes, each of
which is filled with a sphere. Cell 1 is filled with cell 2, which is
designated universe 1. Cell 2 is filled with cells 3 and 4 (universe 2).
It is also a square lattice cell [§5.5.5.2]. Cell 3 is designated
universe -2 indicating it is fully enclosed by surface 11.

The minus universe number of cell 3 indicates that calculating distances
to boundary in higher level cells can be omitted. Cell 3 is a finite
cell and is not truncated by any other cell. Cell 4 cannot have a
negative universe number because it is an infinite region that is
truncated by cell 2. This negative notation can increase computational
efficiency.

The example in Listing 5.14 can be described with macrobodies as shown
in Listing 5.15.

Listing 5.15: example\_universe\_1\_macrobody.mcnp.inp.txt

|   1 | 0   | -20   |      | fill=1   |       |
|-----|-----|-------|------|----------|-------|
|   2 | 0   | -30   | u=1  | fill=2   | lat=1 |
|   3 | 0   | -11   | u=-2 |          |       |
|   4 | 0   | 11    |      |          | u=2   |
|   5 | 0   | 20    |      |          |       |
|  20 | rpp | 0 50  | -10  | 10       | -5 5  |
|  30 | rpp | 0 10  | 0    | 10       | 0 0   |
|  11 | s   | 5     | 0    | 4        | 5     |

## 5.5.5.2 LAT: Lattice

Two different lattice-element shapes can be specified in MCNP6:
hexahedra ( LAT = 1 ), solids with six faces, and hexagonal prisms ( LAT
= 2 ), solids with eight faces. A non-zero entry on the LAT card
indicates that the corresponding cell is the [0 , 0 , 0] element of a
lattice. The hexahedra need not be rectangular and the hexagonal prisms
need not be regular, but the lattices made out of them must fill space
exactly. In other words, opposite sides have to be identical and
parallel. A hexahedral lattice cell may be infinite in one or two of its
dimensions. A hexagonal prism lattice cell may be infinite in the
direction along the length of the prism. The cross-sectional shape of a
lattice element must be convex. It does not matter whether the lattice
is left-handed or right-handed. A lattice must be the only thing in its
universe. The real world (universe level 0) itself can be a lattice. If
a particle leaves the last cell of a real-world, limited-extent lattice
(see the FILL card for how the extent of a lattice can be limited), the
particle escapes and is killed.

The cell description of a lattice cell not only provides the standard
MCNP6 cell description for the base lattice element, but, through the
order of the surface specification for the lattice cell, it identifies
which lattice element lies beyond each surface. The first two surfaces
listed on the cell card define the direction of the first

1

2

3

4

5

6

7

8

9

lattice index; the third and fourth surfaces listed in the cell
description define the direction of the second lattice element, etc.
This concept is further explained in the following discussion.

After designing your lattice, decide which element you want to be the [0
, 0 , 0] element and in which directions you want the three lattice
indices to increase. In the case of a hexagonal prism lattice you have
two constraints: the first and second indices must increase across
adjacent surfaces and the third index must increase in one or the other
direction along the length of the prism. Enter the bounding surfaces of
the [0 , 0 , 0] element on the cell card in the appropriate order, in
accordance with the following conventions. For a hexahedral lattice
cell, beyond the first surface listed is the [1 , 0 , 0] element, beyond
the second surface listed is the [ -1 , 0 , 0] element. Similarly, the
[0 , 1 , 0] , [0 , -1 , 0] , [0 , 0 , 1] , and [0 , 0 , -1] lattice
elements are beyond the 3rd, 4th, 5th, and 6th surfaces in that order.
This method provides the order of arrangement of the lattice to the code
so that when you specify element [7 , 9 , 3] , the code knows to which
element you are referring.

For a hexagonal prism lattice cell, on the opposite side of the first
surface listed is element [1 , 0 , 0] , opposite the second listed
surface is [ -1 , 0 , 0] , followed by the lattice elements [0 , 1 , 0]
, [0 , -1 , 0] , [ -1 , 1 , 0] , [1 , -1 , 0] , [0 , 0 , 1] , and [0 , 0
, -1] , which are opposite the 3rd through 8th surfaces defining the
hexagonal prism [0 , 0 , 0] lattice cell. These last two surfaces must
be the base surfaces of the prism. You can use the MCNP6 geometry
plotter to label the lattice cells with their indices. This provides an
easy way to verify the lattice index arrangement. The example in
§10.1.3.7 illustrates a hexagonal prism lattice cell.

Each cell containing a lattice, whether specified using a LAT keyword or
a LAT data card, must have an associated FILL keyword.

| Cell-card Form: LAT = n or Data-card Form: LAT n1 n2 . . . nJ   | Cell-card Form: LAT = n or Data-card Form: LAT n1 n2 . . . nJ                                                                                                                                    | Cell-card Form: LAT = n or Data-card Form: LAT n1 n2 . . . nJ                                                                                                                                    |
|-----------------------------------------------------------------|--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|
| n                                                               | Lattice type.                                                                                                                                                                                    | Lattice type.                                                                                                                                                                                    |
|                                                                 | n = 1                                                                                                                                                                                            | the cell describes a rectangular (square) lattice comprised of hexahedra with six faces.                                                                                                         |
|                                                                 | n = 2                                                                                                                                                                                            | the cell describes a hexagonal (triangular) lattice comprised of hexagonal prisms with eight faces.                                                                                              |
| nj                                                              | Lattice type assigned to each cell of the problem in the same order as the cells appear in the cell card section                                                                                 | Lattice type assigned to each cell of the problem in the same order as the cells appear in the cell card section                                                                                 |
|                                                                 | nj = 1                                                                                                                                                                                           | the cell describes a rectangular (square) lattice comprised of hexahedra with six faces.                                                                                                         |
|                                                                 | nj = 2                                                                                                                                                                                           | the cell describes a hexagonal (triangular) lattice comprised of hexagonal prisms with eight faces.                                                                                              |
|                                                                 | Note: when provided in the form of a data card, there must be an entry for each of the cells in the problem. The jump feature ( n J ) can be used to pass over cells that are not lattice cells. | Note: when provided in the form of a data card, there must be an entry for each of the cells in the problem. The jump feature ( n J ) can be used to pass over cells that are not lattice cells. |

Use: Used to define an infinite array of hexahedra or hexagonal prisms.
A non-zero entry on the LAT card means that the corresponding cell is
the [0 , 0 , 0] element of a lattice. The order of specification of the
surfaces of a lattice cell identifies which lattice element lies beyond
each surface. Required for lattices.

## 5.5.5.2.1 Example 1

This example is the same as in Listing 5.15. Cell 2 is the base [0 , 0 ,
0] element of a square lattice described by surface 30, a right
parallelepiped with xmin = 0 , xmax = 10 , ymin = 0 , ymax = 10 , and
infinite in the z

direction. It is filled with Universe 2 (cells 3 and 4) and it is
assigned to universe 1, which fills and is bounded by cell 1 (an RPP
with xmin = 0 , xmax = 50 , ymin = -10 , ymax = 10 , zmin = -5 , and
zmax = 5 ). In this case the lattice elements [ i, j, k ] would be [0 :
4 , -1 : 0 , 0 : 0] .

## 5.5.5.3 FILL: Fill

A nonzero entry on the FILL card indicates the number of the universe
that fills the corresponding cell. The same number on the U card
identifies the cells making up the filling universe. If the filled cell
is a lattice, the FILL specification can be either a single entry or an
array. If it is a single entry, every cell of the lattice is filled by
the same universe. If it is an array, the portion of the lattice covered
by the array is filled and the rest of the lattice does not exist. It is
possible to fill various elements of the lattice with different
universes.

## 5.5.5.3.1 Lattice Indexing

The array specification for a cell filled by a lattice has three-
dimension array declarations followed by the array values themselves.
The dimension declarations define the ranges of the three lattice
indices. They are in the same form as in Fortran, but both lower and
upper bounds must be explicitly stated with positive, negative, or zero
integers, separated by a colon. The indices identify each lattice
element's location with respect to the [0 , 0 , 0] element. The LAT card
describes how the specified order of the surfaces of the lattice-element
cell [0 , 0 , 0] determines the ordering of the lattice elements. The
numerical range of the indices depends on where in the lattice the [0 ,
0 , 0] element is located. For example, -5 : 5 , 0 : 10 , and -10 : 0
all define a range of 11 elements.

The array values follow the dimension declarations. Each element in the
array corresponds to an element in the lattice. Only those elements of
the lattice that correspond to elements in the array actually exist. The
value of each array element is the number of the universe that is to
fill the corresponding lattice element. A real world (level zero)
lattice, by default, is universe zero and can only be universe zero.

<!-- formula-not-decoded -->

| See the description of the rotation matrix in §5.5.3, Detail 2 and §5.5.4, Detail 2 .   | See the description of the rotation matrix in §5.5.3, Detail 2 and §5.5.4, Detail 2 .                                                                                                                                                                                                                                         |
|-----------------------------------------------------------------------------------------|-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|
| m                                                                                       | Displacement vector origin. See the description of the displacement vector in §5.5.3.                                                                                                                                                                                                                                         |
| i 1 : i 2 j 1 : j 2 k 1 : k 2                                                           | Lattice element parameters for the upper and lower bounds in the i , j , and k directions (for fully specified fill).                                                                                                                                                                                                         |
| n i , j , k                                                                             | Number of the universe with which to fill each existing lattice element (for fully specified fill). Each element in the array corresponds to an element in the lattice. The portion of the lattice covered by the array is filled and the rest of the lattice does not exist ( 3 ).                                           |
| n n                                                                                     | Number of the universe with which each cell is to be filled in the same order as the cells appear in the cell card section ( 3 ). Note: when provided in the form of a data card, there must be an entry for each of the cells in the problem. The jump feature ( n J ) can be used for cells not assigned a universe number. |

Default:

FILL = 0

Use: Required for repeated structures.

## Details:

- 1 As with a single entry FILL specification, any FILL entry for a fully specified FILL card optionally may be followed by, in parentheses, either a transformation number or the transformation itself. This transformation is between the coordinate systems of the filled cell and the filling universe, with the universe considered to be in the auxiliary coordinate system. If no transformation is specified, the universe inherits the transformation, if any, of the filled cell.
- 2 A * FILL may be used if the rotation matrix entries are angles in degrees rather than cosines. In the data card section of the MCNP input file you cannot have both a FILL and a * FILL entry. If you want to enter some angles by degrees and some angles by cosines, all FILL and * FILL data must be placed on the cell cards of the MCNP input file.
- 3 There are two nj values that can be used in the lattice array that have special meanings. A zero in the level-zero (real world) lattice means that the lattice element does not exist, making it possible, in effect, to specify a non-rectangular array. If the array value is the same as the number of the universe of the lattice, that element is not filled with any universe but with the material specified on the cell card for the lattice cell. Therefore, using the universe number of a real world lattice as an nj value to fill that element with the cell material is not possible.
- 4 The displacement vector, o1 o2 o3 , rotation matrix, xx' yx' zx' xy' yy' zy' xz' yz' zz' , and displacement vector origin, m , must be enclosed in parentheses for the second form.

## 5.5.5.3.2 Example 1

1

2

3

4

```
FILL=0:2 1:2 0:1 4 4 2 $ i=0,1,2 for j=1 & k=0 0 4 0 $ i=0,1,2 for j=2 & k=0 0 3 3 $ i=0,1,2 for j=1 & k=1 4 4 0 $ i=0,1,2 for j=2 & k=1
```

Only eight elements of this lattice exist. Elements [0 , 1 , 0] , [1 , 1
, 0] , [1 , 2 , 0] , [0 , 2 , 1] and [1 , 2 , 1] are filled with
universe 4. Element [2 , 1 , 0] is filled with universe 2. Elements [1 ,
1 , 1] and [2 , 1 , 1] are filled with universe 3.

## 5.5.5.4 URAN: Stochastic Geometry for HTGRs

The URAN card provides a limited means of modeling stochastic geometry
in MCNP6 for both fixed-source and eigenvalue problems. It is primarily
intended for modeling the randomly located fuel kernels in
hightemperature gas-cooled reactor (HTGR) geometries.

## /warning\_sign Caution

Although this feature may have other possible applications, users should
proceed carefully and perform their own verification calculations to
ensure that the feature adequately represents the physical problem they
are modeling.

MCNP6 has been used frequently to model HTGRs with explicit geometric
representation of fuel compacts or pebbles, including the microscopic
fuel kernels within them [221, 222]. Each fuel kernel typically has a
spherical ( ≈ 0 . 5 mm diameter) uranium oxycarbide region surrounded by
layers of graphite, pyrolytic graphite, and silicon carbide. Modular
HTGRs contain cylindrical fuel compacts filled with randomly located
fuel kernels in a graphite matrix. Pebble bed HTGRs contain spherical
fuel pebbles filled with randomly located fuel kernels in a graphite
matrix.

Modeling these geometries in multigroup deterministic codes requires the
implementation of shielding factors to account for double
heterogeneities (i.e., fuel kernels and fuel particles). Monte Carlo
codes that permit hierarchical geometry models, such as MCNP6 with its
embedded lattices and universes, can explicitly model the pebble bed
double heterogeneities. The random locations of fuel kernels within each
fuel compact or pebble are typically modeled in MCNP6 using a regular
lattice arrangement, ignoring any randomness.

To provide a limited form of randomness to the locations of fuel kernels
in HTGR models, the URAN card may be used to flag selected universes in
a lattice as stochastic. This feature provides an additional, random
transformation to the geometry each time a neutron enters the lattice
element. That is, when a neutron enters a lattice element containing an
embedded universe flagged as stochastic, the universe coordinates are
transformed randomly according to

<!-- formula-not-decoded -->

<!-- formula-not-decoded -->

<!-- formula-not-decoded -->

where ξ 1 , ξ 2 , ξ 3 are random numbers uniformly distributed on (0 ,
1) , and δ x , δ y , δ z are user-defined parameters supplied on the
URAN card. Different translation parameters can be declared for
different levels of the geometry, and the random translations are
performed only when entering lattice elements containing universes that
the user declares as stochastic on the URAN card. To preserve mass and
packing fractions, the translation parameters should be chosen such that
fuel kernels or other objects are not displaced beyond the edges of the
enclosing cell or lattice element.

In addition to the random translation applied to a neutron entering a
stochastic universe, special treatment is needed to save the fission
sites in an eigenvalue calculation. When a fission occurs and the site
parameters are saved in the fission bank, the current values of the
random translation parameters must be saved along with the normal
fission-site data. In the next cycle of the calculation, these saved
translation parameters are used for the neutron starting at that fission
site. This ensures that the flight continues from the same stochastic
realization in effect when the site was saved.

This stochastic geometry treatment has been verified for several
realistic HTGR problems [221, 222].

| Data-card Form: URAN n1 d1x d1y d1z n2 d2x d2y d2z . . . nJ dJx dJy dJz   | Data-card Form: URAN n1 d1x d1y d1z n2 d2x d2y d2z . . . nJ dJx dJy dJz                                        |
|---------------------------------------------------------------------------|----------------------------------------------------------------------------------------------------------------|
| nj                                                                        | Universe number to which to apply stochastic transformation. Only applied when used to fill a lattice element. |
| djx                                                                       | Maximum translation in the ± x direction for stochastic transformation applied to universe nj .                |
| djy                                                                       | Maximum translation in the ± y direction for stochastic transformation applied to universe nj .                |
| djz                                                                       | Maximum translation in the ± z direction for stochastic transformation applied to universe nj .                |

Default: None.

Use: To model random nature of HTGR or similar geometries.

## /warning\_sign Caution

There is no stochastic geometry plotting capability associated with the
URAN card. Users should be extremely cautious in supplying information
using the URAN card because MCNP6 has no means of checking whether the
supplied parameters properly represent the physical model being
simulated.

## 5.5.6 Hybrid Geometries: Structured and Unstructured Meshes

A geometry mesh from an external file can be embedded into an MCNP
constructive solid geometry model using the 'universe' construct from
the repeated structures capability. The embedded geometry mesh may be
structured or unstructured.

A structured mesh, such as that defined by the geometry/materials block
of the PARTISN discrete ordinates (S N ) code [223], can be embedded
into an MCNP geometry. The resultant hybrid geometry can then be used
for the MCNP calculations. The only structured-mesh geometry file format
that the MCNP code can process is LNK3DNT, a binary file format used by
the PARTISN code. The MCNP code can import a geometry description from a
LNK3DNT file for continuous-energy neutron particle transport. It is
also possible to convert an MCNP constructive solid geometry to a
structured mesh geometry. This capability samples an MCNP constructive
solid geometry, creates a homogenized regular mesh of materials in 1-D (
r ) , 2-D ( r, z ) , or 3-D ( x, y, z ) or ( r, z, θ ) , and writes a
structured mesh model in the file formatted as LNK3DNT.

Unstructured meshes, such as those created by the Abaqus/CAE code (
https://www.3ds.com/products-services/ simulia/products/abaqus ), also
can be embedded in a hybrid arrangement. Many other computer-aided
engineering (CAE) or mesh generation tools have the ability to generate
a mesh from a solid model that can be converted to the Abaqus format.
The MCNP code can process meshes that consist of four-, five-, or

six-sided finite elements, with linear, bi-linear, or quadratic faces.
Starting with the MCNP code, version 6.3, the code can process a mesh
formatted as an Abaqus input file or an HDF5 mesh input file; see §D.6
for an HDF5 mesh input file format.

Before creating or incorporating structured or unstructured meshes, it
is highly recommended that the interested user become familiar with
Chapter 8 and external references, as appropriate [224-226]. This
section is not meant to provide information regarding PARTISN or Abaqus
file formats nor provide a primer on how to run or interact with these
codes.

## 5.5.6.1 Creation of a Structured Mesh Geometry File

LNK3DNT-format files, used by the LANL PARTISN code, can be created from
an MCNP input file [226]. Two cards are required to accomplish this
task: the MESH card and the DAWWG card. It is a known issue that some
complex constructive solid geometries or unstructured mesh geometries in
MCNP input files cannot be converted into correct LNK3DNT format files;
that is PARTISN may not be able to read some LNK3DNT files created by
the MCNP code.

## 5.5.6.2 MESH: Superimposed Importance Mesh for Mesh-Based Weight-Window Generator

The MESH card specifies the layout and orientation of the geometry to be
generated with respect to the cell-based coordinate system. For this
application, the supported coordinate-system options include XYZ ( x, y,
z ) , CYL in either 2-D ( r, z ) or 3-D ( r, z, θ ) , and SPH ( r ) .
The optional ORG , AXS , and VEC keywords of the MESH card can be used
to align the mesh with the MCNP geometry from which the discrete-
ordinates geometry will be generated.

The geometry orientation is not transferred to the resultant LNK3DNT
file. Regarding the MESH orientation parameters, the generated
homogenized geometry will have a geometric center at (0 , 0 , 0) and
will be aligned with the global MCNP Cartesian coordinate system. For
cylindrical geometries, the defaults are that the cylinder axis is
aligned with the positive z axis and the azimuthal plane ( θ = 0 ) is
aligned with the positive x axis.

## 5.5.6.3 DM: Target Aliases for Deterministic Materials

When generating a PARTISN input using the DAWWG card, the nuclide
identifiers in the matls input array in Block IV need to be set. By
default, the code will convert the identifier to the ZAID format and
remove the suffix (e.g., U-238.80c would be written as 92238 ). The DM
card allows the user to override this nuclide mapping on a material-by-
material basis.

| Data-card Form: DM n original _ target _ 1 new _ target _ 1 original _ target _ 2 new _ target _ 2 . . .   | Data-card Form: DM n original _ target _ 1 new _ target _ 1 original _ target _ 2 new _ target _ 2 . . .                                                                               |
|------------------------------------------------------------------------------------------------------------|----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|
| n                                                                                                          | The material to which this card applies. If n = 0 , this card will apply to all materials.                                                                                             |
| original _ target _ j                                                                                      | Any target identifier of the forms in §1.2.3. All targets with the same Z , A , and S will be overridden with the matching new _ target _ j . The suffix, if present, will be ignored. |
| new _ target _ j                                                                                           | The replacement target identifier for matls in Block IV in the PARTISN input. The MCNP code will read and write identifiers up to 8 characters in length.                              |

Default: The target identifiers on the material card will be used with
the suffix removed.

1

2

3

## 5.5.6.4 DAWWG: Deterministic Adjoint Weight-window Generator

The DAWWG card specifies the number of points to sample in each element
of the mesh. This sampling is used to estimate the volume fraction of
different materials within each element. From this information a
homogenized material definition with its associated density can be
generated for each element. DAWWG may also be used to pass information
directly to PARTISN.

## /warning\_sign Caution

The DAWWG card must appear after the MESH card in the input file's data
section.

| POINTS = n   | keyword = values(s) Randomly sample the material within each element of the defined mesh using n sample points in each coordinate direction for each mesh element, where n is an integer. This sampling is used to estimate material volume fractions and thereby estimate the composition of each geometry element. (DEFAULT: POINTS = 1 ) Required. For example: if n = 10 , then 10 3 = 1000 points will be sampled in each geometry mesh element.   | keyword = values(s) Randomly sample the material within each element of the defined mesh using n sample points in each coordinate direction for each mesh element, where n is an integer. This sampling is used to estimate material volume fractions and thereby estimate the composition of each geometry element. (DEFAULT: POINTS = 1 ) Required. For example: if n = 10 , then 10 3 = 1000 points will be sampled in each geometry mesh element.   |
|--------------|---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|
| XSEC = name  | Declares that cross-section library name will be passed to the discrete-ordinates code for weight-window generation. This information is not explicitly used in the generation of the mesh. (Required) a                                                                                                                                                                                                                                                | Declares that cross-section library name will be passed to the discrete-ordinates code for weight-window generation. This information is not explicitly used in the generation of the mesh. (Required) a                                                                                                                                                                                                                                                |
| TALLY = i    | b                                                                                                                                                                                                                                                                                                                                                                                                                                                       | b                                                                                                                                                                                                                                                                                                                                                                                                                                                       |
| BLOCK = k    | Passes values from an MCNP input file to a PARTISN input file. (Optional) Multiple BLOCK entries are permitted. The allowed keywords and generally suitable for each BLOCK are provided in Tables 5.3, 5.4, 5.5, and 5.6. If                                                                                                                                                                                                                            | Passes values from an MCNP input file to a PARTISN input file. (Optional) Multiple BLOCK entries are permitted. The allowed keywords and generally suitable for each BLOCK are provided in Tables 5.3, 5.4, 5.5, and 5.6. If                                                                                                                                                                                                                            |
| BLOCK = k    | BLOCK = 1                                                                                                                                                                                                                                                                                                                                                                                                                                               | then pass values of the listed keywords to the dimension and controls block of the PARTISN input file [Table 5.3].                                                                                                                                                                                                                                                                                                                                      |
| BLOCK = k    | BLOCK = 3                                                                                                                                                                                                                                                                                                                                                                                                                                               | then pass values of the listed keywords to the nuclear data type and options block of the PARTISN input file [Table 5.4].                                                                                                                                                                                                                                                                                                                               |
| BLOCK = k    | BLOCK = 5                                                                                                                                                                                                                                                                                                                                                                                                                                               | then pass values of the listed keywords to the solver input block of the PARTISN input file [Table 5.5].                                                                                                                                                                                                                                                                                                                                                |
| BLOCK = k    | BLOCK = 6                                                                                                                                                                                                                                                                                                                                                                                                                                               | then pass values of the listed keywords to the edit controls block of the PARTISN input file [Table 5.6].                                                                                                                                                                                                                                                                                                                                               |

## 5.5.6.4.1 Example 1

Listing 5.16: example\_dawwg.mcnp.inp.txt

| Converts MCNP cube geometry to LNK3DNT   |
|------------------------------------------|
| 1 1 -18.7 -1 imp:n=1                     |
| 2 0 1 imp:n=0                            |

Table 5.3: PARTISN Block 1: Dimension and Control Defaults Suitable for the DAWWG Card

| Block Keyword   | Type    |   Default | Description                                |
|-----------------|---------|-----------|--------------------------------------------|
| NGROUP          | Integer |        30 | Number of energy groups                    |
| ISN             | Integer |         8 | S N order                                  |
| NISO            | Integer |         0 | Number of isotopes                         |
| MT              | Integer |         1 | Number of materials                        |
| IQUAD           | Integer |         6 | Quadrature (1-9)                           |
| FMMIX           | Integer |         1 | 1 means read composition from LNK3DNT file |
| NOSOLV          | Integer |         0 | 1 means suppress solver module             |
| NOEDIT          | Integer |         0 | 1 means suppress edit module               |
| NOGEOD          | Integer |         0 | 1 means suppress writing GEODST file       |
| NOMIX           | Integer |         0 | 1 means suppress writing mixing files      |
| NOASG           | Integer |         0 | 1 means suppress writing ASGMAT file       |
| NOMACR          | Integer |         0 | 1 means suppress writing MACRXS file 1     |
| NOSLNP          | Integer |         0 | means suppress writing SOLINP file         |
| NOEDTT          | Integer |         0 | 1 means suppress writing EDITIT file       |
| NOADJM          | Integer |         0 | 1 means suppress writing ADJMAC file       |

Table 5.4: PARTISN Block 3: Nuclear Data Type and Options Defaults Suitable for the DAWWG Card

| Block Keyword   | Type    | Default   | Description                            |
|-----------------|---------|-----------|----------------------------------------|
| LIB             | Text    | ndilib    | Form of the cross-section data file    |
| LIBNAME         | Text    | mendf5    | Cross-section file name                |
| FISSNEUT        | Integer | 0         | Fission neutron flag                   |
| LNG             | Integer | 0         | Number of the last neutron group       |
| BALXS           | Integer | 0         | Cross-section balance control (-1,0,1) |
| NTICHI          | Integer | 0         | MENDF fission fraction to use          |

Table 5.5: PARTISN Block 5: Solver Defaults Suitable for the DAWWG Card

| Block Keyword   | Type    | Default   | Description                                    |
|-----------------|---------|-----------|------------------------------------------------|
| IEVT            | Integer | 1         | Calculation type (0-4)                         |
| ISCT            | Integer | 3         | Legendre order                                 |
| ITH             | Integer | 0         | Direct (0) or adjoint (1) calculation          |
| TRCOR           | Text    | diag      |                                                |
| IBL             | Integer | 0         | Left boundary condition                        |
| IBR             | Integer | 0         | Right boundary condition                       |
| IBT             | Integer | 0         | Top boundary condition                         |
| IBB             | Integer | 0         | Bottom boundary condition                      |
| IBFRNT          | Integer | 0         | Front boundary condition                       |
| IBBACK          | Integer | 0         | Back boundary condition                        |
| EPSI            | Real    | 0.0001    | Convergence precision                          |
| OITM            | Integer | 20        | Maximum outer iteration count                  |
| NOSIGF          | Integer | 0         | 1=inhibit fission multiplication               |
| SRCACC          | Text    | DSA       | Transport acceleration ( DSA , TSA , NO )      |
| DIFFSOL         | Text    | mg        | Diffusion operator solver                      |
| TSASN           | Integer | 0         | S N order for low order TSA sweeps             |
| TSAEPSI         | Real    | 0.0       | Convergence criteria for TSA sweeps            |
| TSAITS          | Integer | 0         | Maximum TSA iteration count                    |
| TSABETA         | Real    | 0.0       | Scattering cross-section reduction for TSA     |
| PTCONV          | Integer | 0         | 1=Special criticality convergence scheme       |
| NORM            | Real    | 1.0       |                                                |
| XSECTP          | Integer | 0         | Cross-section print flag (0, 1, 2)             |
| FISSRP          | Integer | 1         | 1 means print fission source rate              |
| SOURCP          | Integer | 0         | Source print flag (0, 1, 2, 3)                 |
| ANGP            | Integer | 0         | 1 means print angular flux                     |
| BALP            | Integer | 0         | 1 means print coarse-mesh balance tables       |
| RAFLUX          | Integer | 0         | 1 means prepare angular flux file              |
| RMFLUX          | Integer | 0         | 1 means prepare flux moments file              |
| AVATAR          | Integer | 0         | 1 means prepare special XMFLUXA file           |
| ASLEFT          | Integer | i         | i means right-going flux at plane i (0: none)  |
| ASRITE          | Integer | i         | i means left-going flux at plane i (0: none)   |
| ASBOTT          | Integer | j         | j means top-going flux at plane j (0: none)    |
| ASTOP           | Integer | j         | j means bottom-going flux at plane j (0: none) |
| ASFRNT          | Integer | k         | k means back-going flux at plane k (0: none)   |
| ASBACK          | Integer | k         | k means front-going flux at plane k (0: none)  |

Table 5.6: PARTISN Block 6: Edit Control Defaults Suitable for the DAWWG Card

| Block Keyword   | Type    |   Default | Description                                                |
|-----------------|---------|-----------|------------------------------------------------------------|
| MASSED          | Integer |         1 | 1 enables mass edits                                       |
| PTED            | Integer |         0 | 1 enables edits by fine mesh                               |
| ZNED            | Integer |         0 | 1 enables edits by (edit) zone                             |
| RZFLUX          | Integer |         0 | 1 means write a-flux file                                  |
| RZMFLUX         | Integer |         0 | 1 means write b-flux file                                  |
| EDOUTF          | Integer |         3 | ASCII output files control [-3:3]                          |
| BYVOLP          | Integer |         0 | 1 means printed point reaction rates scaled by mesh volume |
| AJED            | Integer |         0 | Regular (0) and Adjoint (1) edit                           |
| FLUXONE         | Integer |         0 | 1 means flux override                                      |

```
4 5 1 rpp -10 10 -10 10 -10 10 6 7 kcode 5000 1.0 50 250 8 ksrc 0.0 0.0 0.0 9 m1 92235.69c 1.0 10 dm1 92235 92235.50 11 prdmp j 275 12 mesh geom xyz 13 ref 0.0 -0.0 -0.0 14 origin -10.000 -10.000 -10.000 15 imesh 10 16 iints 2 17 jmesh 10 18 jints 2 19 kmesh 10 20 kints 2 21 f4:n 1 22 dawwg points=10 23 block=1 ngroup=16 isn=16 iquad=4 24 block=3 libname=mendf5 lib=ndilib 25 block=5 trcor=diag srcacc=dsa diffsol=mg isct=2 26 block=6 massed=1 edoutf=3
```

The MCNP input file in Listing 5.16 creates a LNK3DNT-format mesh file
of a solid, one-material cube with density 18.7 g/cm 3 . Each edge of
the cube is 20 cm long ( -10 &lt; x, y, z &lt; 10 cm) and has two mesh
segments along each cardinal direction (i.e., mesh boundaries at x, y, z
= -10 , 0 , 10 cm). In each element of the mesh, 1000 points will be
randomly sampled to estimate the material composition in each element.
The DAWWG card is used to pass additional options directly to the
PARTISN discrete ordinates code. These additional options are not used
by the MCNP code.

## 5.5.6.4.2 Example: Creation of Structured Mesh File

After an MCNP input file has been created to generate the structured
mesh file, execute the code using the M execution option:

mcnp6 M I=MYINP LINKOUT=MYLNK

The LNK3DNT file created by the MCNP code is named LINKOUT by default
but can be changed via file name assignment on the execution line. If a
file with the name LINKOUT already exists, the MCNP code will adhere to
the usual rules for selecting a file name. In the example, the MCNP
input file is MYINP and the LNK3DNT output file is MYLNK . When invoked
in this manner, the code will process the input file, generate the
LINKOUT file, and exit.

## 5.5.6.5 Mesh Importation and Specification of an Embedded Geometry

Structured and/or unstructured mesh geometries may be embedded into the
MCNP code by using the repeated structure's universe ( U ) and fill (
FILL ) constructs. When used in the MCNP code, an embedded geometry must
be assigned to an MCNP universe. To ensure that this universe will
completely fill the cell in which it is placed, a background cell that
represents the infinite region surrounding the embedded geometry

1

must also be assigned to the same universe. The embedded mesh geometry
must not be clipped by the fill cell into which it is placed and no
other universe or cell may be contained within it. This combination of
the mesh geometry that is to be embedded and its surrounding infinite
cell is called a 'mesh universe.' Similar to other repeated structures,
a mesh universe may be placed in multiple locations within an MCNP
geometry; also, more than one unique unstructured mesh universe may be
embedded into an MCNP geometry, but only one LNK3DNT mesh may be
embedded.

In the MCNP code, space is defined by a collection of cells using
surfaces, lattices, universes, fills, etc. Building on this cell-
geometry concept, incorporation of an embedded geometry into the code
requires defining cells to represent the embedded geometry and its
composition. There are three special MCNP cell categories for specifying
the use of an embedded geometry: pseudo-cells [§8.2], background cells
[§8.2], and fill cells [§5.5.5.3]. The treatment of these cells differs
depending on the type of embedded mesh; this concept is explained in
great detail below. Each embedded mesh universe consists of one or more
pseudo-cells and a single background cell.

Pseudo-cells are defined in the MCNP cell block by a null surface-with a
surface number of '0'. These pseudo-cells are used to communicate normal
MCNP cell properties from the external mesh to the MCNP code. The cell-
card format for pseudo-cells exhibits the following properties that
differ from those of regular MCNP cells:

- Pseudo-cells have a single null-surface entry (i.e., 0) instead of a list of signed surfaces.
- Pseudo-cells are assigned to a universe (e.g., U = 10 or U = E 10 where the E prefix to the universe is optional and signifies a mesh universe).
- The universe number of the pseudo-cell must match the n specified on its associated EMBED n card.
- Pseudo-cells cannot be filled by another universe or lattice (i.e., a pseudo-cell cannot have a FILL or LAT entry).

Pseudo-cell cards may contain material, density, importance, and other
cell properties. All cell-card fields that typically are required by
regular MCNP cells also are required by pseudo-cells. How the user
should think about these cells differs slightly depending on the type of
embedded mesh. As will be seen in the next section, the pseudo-cells are
connected to an embedded geometry through the MATCELL entries on the
associated EMBED card.

For the PARTISN mesh, a pseudo-cell cell must exist for each material
defined in an embedded geometry mesh input file. If void elements exist,
a separate pseudo-cell is required to represent them. Pure elements,
i.e., those that contain only one material or void, belong to only one
pseudo-cell. Multi-material elements, however, belong to each pseudo-
cell that is associated with a material contained in the element.
Material density is assigned to each mesh element within the external
mesh geometry file. The materials within the LNK3DNT geometry file must
be numbered using non-negative integers, where 0 is for a void. The
material information in the external mesh file is transferred to the
MCNP code through the pseudo-cells and the MATCELL keyword of EMBED
card; each unique material in the external mesh file must have an
associated pseudo-cell, where the first and second entries of the
MATCELL keyword are respectively material numbers read from a LNK3DNT
file and the pseudo-cell numbers in the MCNP cell block.

For the Abaqus unstructured mesh, the unstructured mesh library that
handles all of the details of unstructured meshes for the MCNP code
establishes pseudo-cells (unique combinations of materials and element
sets) from the information contained in the Abaqus input file. The
reader is referred to Chapter 8 for details on this topic. A pseudo-cell
cross-reference table is printed to the MCNP output file. Among other
things, this table lists the known pseudo-cells and the associated
material assignments that are expected. For each pseudo-cell entry in
this table, there must be a pair of values for the MATCELL keyword on
the EMBED card. The first and second entries of the MATCELL keyword are
the unstructured mesh pseudo-cell numbers processed from the

mesh input file and the pseudo-cell numbers defined in the MCNP cell
block. The first entries of the MATCELL keyword must start from 1 and
increase by 1. This MATCELL association connects the MCNP pseudo-cells
with the unstructured mesh pseudo-cells and is essential to establish
the material properties for the unstructured mesh pseudo-cells because
the only required material property in the mesh file is the material
numbers. It is up to the user to ensure that this information is input
correctly through the MATCELL entries on the associated EMBED card. For
large and complex geometries, this can be a tedious process. To help
with this input setup, users should take advantage of the unstructured
mesh pre-processor program: um \_ pre \_ op [227], which is now deprecated
[DEP-53422].

Mesh element assignment to each MCNP pseudo-cell is determined by the
data as it appears in the external geometry mesh file. For a given
geometry mesh, if the element sets of the mesh are built in a different
order, then the mapping to the associated MCNP pseudo-cells will also be
different. The user is directed to the previous list of references to
decipher the cross-reference mapping data provided in the external
geometry mesh file.

To make a mesh universe [§8.2] infinite in extent, it must have a
background cell that consists of all space outside the associated
embedded geometry. The background cell is connected to the mesh universe
through the BACKGROUND entry on the EMBED card. The format of the
background cell in MCNP cell-card definitions is the same as pseudo-
cells.

The third cell type required to embed a mesh geometry into a MCNP input
is the fill cell. The fill cell is a regular MCNP cell into which the
mesh universe is placed. Mesh surfaces should not be coincident with
fill-cell surfaces, otherwise lost particles may result. The cell card
for a cell filled with a mesh universe has the following properties that
differ from those of other MCNP fill cells:

- A fill cell cannot be a pseudo-cell (i.e., it must be defined using bounding surfaces and not use a null, 0, surface).
- Fill cells have a fill entry of the form FILL = E n or FILL = n , where n is the MCNP universe number of the mesh universe. This universe number, n , also appears as the n on the EMBED n card. The FILL entry may have a transformation ( TR ) to permit realignment of the embedded geometry within the fill cell. Recall that LNK3DNT geometries are always defined relative to the MCNP origin.
- Fill cells cannot have a lattice entry.

Eight MCNP data cards are available to support mesh importation. The
EMBED card is required for both structured and unstructured mesh
importation. Seven additional cards ( EMBEE , EMBEB , EMBEM , EMBTB ,
EMBTM , EMBDE , and EMBDF ) are optional and only valid for unstructured
meshes. These seven cards provide for elemental edits, i.e., results
accumulated on the unstructured mesh. These mesh results, along with a
generic description of the unstructured mesh model, can be output to a
special elemental-edit output (EEOUT) file [§8.4]. Not all tally
features are duplicated with the unstructured mesh elemental edit
capability, hence the name edit instead of tally. If traditional MCNP
statistical analysis is desired for the results, the user must set up a
tally for the appropriate pseudo-cell(s).

Be aware that there are additional limitations when using an
unstructured mesh in an MCNP geometry. Consult Chapter 8 for an up-to-
date list and more detailed guidance on using the UM feature.

## 5.5.6.6 EMBED: Embedded Geometry Specification

One card, EMBED , is required for embedding a mesh geometry into an MCNP
input file. For each unique embedded geometry used in an MCNP input
file, there must exist an associated EMBED card.

## /\_445 Deprecation Notice

DEP-53361

The BACKGROUND pseudo-cell listed on the EMBED must be unique from all
MATCELL pseudo-cell entries. This is noted in 2 , but has not been
strictly enforced allowing embedded mesh BACKGROUND cell and MATCELL
cells to list the same pseudo-cell. This flexibility will be removed in
a future version of the MCNP code to strictly require a unique
BACKGROUND cell.

It is recommended to add a unique cell in the MCNP cell block that
corresponds only to the BACKGROUND pseudo-cell (not included within the
MATCELL pseudo-cell listing(s)).

<!-- image -->

| Data-card Form: EMBED       | n keyword = values(s)                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                           | n keyword = values(s)                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                           |
|-----------------------------|-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|
| n                           | The universe number assigned to the embedded mesh, which must match a universe number specified on the pseudo-cell cards. ( 1 ).                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                | The universe number assigned to the embedded mesh, which must match a universe number specified on the pseudo-cell cards. ( 1 ).                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                |
| BACKGROUND = c              | Cell number of the background pseudo-cell. (Required)                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                           | Cell number of the background pseudo-cell. (Required)                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                           |
| MATCELL = m1 c1 m2 c2 . . . | MATCELL = m1 c1 m2 c2 . . .                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     | MATCELL = m1 c1 m2 c2 . . .                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     |
|                             | Integer material-cell pairs. (Required)                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                         | Integer material-cell pairs. (Required)                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                         |
|                             | For the structured mesh, there is one pair for each material (including void), where mi values are the embedded mesh material numbers and ci is the pseudo-cell number associated with mi . If the material is void, mi = 0 ( 2 , 3 ). mi values must be in a LNK3DNT file. For the unstructured mesh there is one pair associating each pseudo-cell in the unstructured mesh ( mi ) file with one pseudo-cell in the MCNP cell block ( ci ). Pseudo-cells in the unstructured mesh are numbered sequentially, beginning with 1. A void, mi = 0 , is not used by the unstructured mesh. See the pseudo-cell cross-reference table in the MCNP output file for the expected pairings or use the utility program to assist with problem setup. mi | For the structured mesh, there is one pair for each material (including void), where mi values are the embedded mesh material numbers and ci is the pseudo-cell number associated with mi . If the material is void, mi = 0 ( 2 , 3 ). mi values must be in a LNK3DNT file. For the unstructured mesh there is one pair associating each pseudo-cell in the unstructured mesh ( mi ) file with one pseudo-cell in the MCNP cell block ( ci ). Pseudo-cells in the unstructured mesh are numbered sequentially, beginning with 1. A void, mi = 0 , is not used by the unstructured mesh. See the pseudo-cell cross-reference table in the MCNP output file for the expected pairings or use the utility program to assist with problem setup. mi |
|                             | must start from 1 and increase by 1.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            | must start from 1 and increase by 1.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            |
| MESHGEO = format            | Format specification of the embedded mesh input file. Required.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                 | Format specification of the embedded mesh input file. Required.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                 |
|                             | MESHGEO = LNK3DNT                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                               | the embedded (structured) geometry file is in LNK3DNT format.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                   |
|                             | MESHGEO = ABAQUS                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                | the embedded (unstructured) geometry file is in Abaqus format [§8.7].                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                           |
|                             | MESHGEO = MCNPUM                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                | the Abaqus format has been converted to the format used internal to the MCNP code, now deprecated [DEP-53424].                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                  |
|                             | MESHGEO = HDF5                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                  | the embedded (unstructured) geometry file is in an HDF5 file [§D.6].                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            |
| MGEOIN = filename           | Name of the input file containing the mesh description. (Required)                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              | Name of the input file containing the mesh description. (Required)                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              |
| MEEOUT = filename           | Name of the (legacy) EEOUT results file [DEP-53294] to write; if not specified, no legacy EEOUT file is written (Unstructured mesh only)                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        | Name of the (legacy) EEOUT results file [DEP-53294] to write; if not specified, no legacy EEOUT file is written (Unstructured mesh only)                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        |
| MEEIN = filename            | Name of the (legacy) EEOUT results file [DEP-53294] to read; required for a restarted calculation if not using HDF5-based information (see HDF5FILE entry). Must not be the same as MEEOUT . Must not be present if the HDF5FILE entry is present.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              | Name of the (legacy) EEOUT results file [DEP-53294] to read; required for a restarted calculation if not using HDF5-based information (see HDF5FILE entry). Must not be the same as MEEOUT . Must not be present if the HDF5FILE entry is present.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              |
| CALC _ VOLS = value         | Select the volume calculation (Structured mesh only; Optional), if                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              | Select the volume calculation (Structured mesh only; Optional), if                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              |

|                       | CALC _ VOLS = YES                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        | calculate the inferred geometry cell volumes and masses.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                 |
|-----------------------|----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|
|                       | CALC _ VOLS = NO                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                         | do not calculate the inferred geometry cell volumes and masses.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          |
| DENTYPE = value       | Select the density type in a LNK3DNT file (Structured mesh only; Required), if                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                           | Select the density type in a LNK3DNT file (Structured mesh only; Required), if                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                           |
|                       | DENTYPE = MASS DENTYPE = ATOM                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            | densities in a LNK3DNT file are mass densities. densities in a LNK3DNT file are atom densities.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          |
| DEBUG = value         | If DEBUG = ECHOMESH , write the embedded geometry parameters to the OUTP file. (No other values are supported at this time; Structured mesh only; Optional)                                                                                                                                                                                                                                                                                                                                                                                                                                              | If DEBUG = ECHOMESH , write the embedded geometry parameters to the OUTP file. (No other values are supported at this time; Structured mesh only; Optional)                                                                                                                                                                                                                                                                                                                                                                                                                                              |
| ELEMENTCHK = value    | Toggle UM elemental quality metric calculation and reporting (Unstructured mesh only; Optional), if                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      | Toggle UM elemental quality metric calculation and reporting (Unstructured mesh only; Optional), if                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      |
|                       | ELEMENTCHK = YES                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                         | calculate and report elemental quality metrics during UM input processing. (DEFAULT)                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     |
|                       | ELEMENTCHK = NO                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          | do not assess elemental quality metrics during UM input processing.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      |
| FILETYPE = type       | File type for the elemental edit output file. (Unstructured mesh only; Optional) If                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      | File type for the elemental edit output file. (Unstructured mesh only; Optional) If                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      |
|                       | FILETYPE = ASCII                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                         | then write the elemental edit output file in ASCII format. (DEFAULT)                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     |
|                       | FILETYPE = BINARY                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        | then write the elemental edit output file as a binary file.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              |
| GMVFILE = filename    | Name of the GMV output file.(Unstructured mesh only; Optional) General Mesh View (GMV) is an external program written to support mesh geometry visualization [228]. This option is now deprecated [DEP-53519].                                                                                                                                                                                                                                                                                                                                                                                           | Name of the GMV output file.(Unstructured mesh only; Optional) General Mesh View (GMV) is an external program written to support mesh geometry visualization [228]. This option is now deprecated [DEP-53519].                                                                                                                                                                                                                                                                                                                                                                                           |
| HDF5FILE = filename   | File name for the HDF5-based elemental edit output file and prefix for the associated XDMF file. For example, specifying HDF5FILE=eeout.h5 will produce two files: the binary HDF5 file eeout.h5 and the ASCII XML file eeout.h5.xdmf . If this option is present, restart information is also written (currently to the /restart/unstructured _ mesh group of the MCNP runtape file) and used (from the same location), as applicable. When the MCNP code is executed with an input option only, the binary HDF5 file and the ASCII XML file are created where these files contain only the mesh model. | File name for the HDF5-based elemental edit output file and prefix for the associated XDMF file. For example, specifying HDF5FILE=eeout.h5 will produce two files: the binary HDF5 file eeout.h5 and the ASCII XML file eeout.h5.xdmf . If this option is present, restart information is also written (currently to the /restart/unstructured _ mesh group of the MCNP runtape file) and used (from the same location), as applicable. When the MCNP code is executed with an input option only, the binary HDF5 file and the ASCII XML file are created where these files contain only the mesh model. |
| LENGTH = f            | A multiplicative conversion factor to centimeters for all mesh dimensions in the input and output files (DEFAULT: f = 1 ) (Unstructured mesh only; Optional)                                                                                                                                                                                                                                                                                                                                                                                                                                             | A multiplicative conversion factor to centimeters for all mesh dimensions in the input and output files (DEFAULT: f = 1 ) (Unstructured mesh only; Optional)                                                                                                                                                                                                                                                                                                                                                                                                                                             |
| MCNPUMFILE = filename | MCNPUMFILE = filename                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    | MCNPUMFILE = filename                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    |
|                       | Name of the MCNPUM output file. This option is deprecated [DEP-53424].                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                   | Name of the MCNPUM output file. This option is deprecated [DEP-53424].                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                   |
| OVERLAP = key value   | Model to treat overlapping parts ( 4 ). First entry should be one of the following:                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      | Model to treat overlapping parts ( 4 ). First entry should be one of the following:                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      |
|                       | • EXIT (default when OVERLAP is not provided), • ENTRY                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                   | • EXIT (default when OVERLAP is not provided), • ENTRY                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                   |

## Details:

- 1 This universe number must match those specified on the related inferred-cell cards.
- 2 The MATCELL keyword entries must have one m 1 -c 1 pair for each structured material or unstructured mesh pseudo-cell in the embedded mesh. A unique pseudo-cell must exist in the MCNP cell block for each unique structured mesh material or unstructured mesh pseudo-cell [DEP-53361]. If there are void elements in the embedded structured mesh geometry, there must also be a MATCELL entry pair for material 0 and an associated pseudo-cell. The assigned BACKGROUND cell must be a unique pseudo-cell. A warning is issued if there are pseudo-cells that are not listed on the BACKGROUND or MATCELL entries. It is a fatal error if a structured mesh material or unstructured mesh pseudo-cell appears in the external mesh file that is not mapped to a pseudo-cell.
- 3 In the case of a structured mesh, while pseudo-cells associated with non-void embedded geometry mesh elements must have a specified density, MCNP6 uses the element-specific densities stored in the external mesh file for transport (e.g., cross-section lookup) and plotting. The density for the pseudo-cell on the cell card should be considered a reference density.
- 4 The OVERLAP treatments are currently ignored and the EXIT treatment is always applied.

## 5.5.6.7 EMBEE: Embedded Elemental Edits Control

If no EMBEE card is present, a cumulative elemental track-length fluence
edit is created, without statistical uncertainties, for each particle on
the MODE card.

| Data-card Form: EMBEE n : P keyword = values(s)   | Data-card Form: EMBEE n : P keyword = values(s)                                                                                                                                                 |
|---------------------------------------------------|-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|
| n                                                 | Elemental edit number ending in 4, 6, or 7. These values follow the F4 , F6 , and F7 tally convention.                                                                                          |
| P                                                 | Particle designator. Restriction: Only n or p or n,p or individual charged particles.                                                                                                           |
| EMBED = value                                     | Embedded mesh universe number. Must correspond to a valid EMBED card and mesh universe number. (Required)                                                                                       |
| COMMENT = value                                   | Edit comment to appear in the legacy EEOUT file [DEP-53294] or the HDF5 EEOUT file; limited to 128 lower case alphanumeric characters. Similar functionality as FC card for tallies. (Optional) |
| ENERGY = value                                    | Multiplicative conversion factor from MeV/g for all energy-related output. (DEFAULT: value = 1 ) (Optional)                                                                                     |
| ERRORS = value                                    | Record relative fractional uncertainty to the legacy EEOUT file [DEP-53294] or HDF5 EEOUT file. NO or YES (default). (Optional)                                                                 |

## · AVERAGE .

Treatments for individual pseudo-cells can be specified by following the
initial entry with a second parameter and a list of valid pseudo-cell
numbers (from the MATCELL entry).

| TIME = value   | Multiplicative conversion factor from shakes for all time-related output. (DEFAULT: value = 1 ) (Optional)                                                                                                | Multiplicative conversion factor from shakes for all time-related output. (DEFAULT: value = 1 ) (Optional)                                                                                                |
|----------------|-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|
| ATOM = value   | Flag to multiply by atom density; NO (default) or YES . (Optional)                                                                                                                                        | Flag to multiply by atom density; NO (default) or YES . (Optional)                                                                                                                                        |
| FACTOR = value | Multiplicative constant; default: 1.0; equivalent in concept to | C | on the FM card. (Optional)                                                                                                          | Multiplicative constant; default: 1.0; equivalent in concept to | C | on the FM card. (Optional)                                                                                                          |
| LIST = values  | Reaction list where this is the sum and/or product of ENDF or special reaction numbers. Limited to 1 reaction list as with FMESH tallies. Parentheses can be used but are ignored by the code. (Optional) | Reaction list where this is the sum and/or product of ENDF or special reaction numbers. Limited to 1 reaction list as with FMESH tallies. Parentheses can be used but are ignored by the code. (Optional) |
| MAT = value    | Material number identified on an M n card. Can be a dummy material or 0 (default). If the value is 0, use the cell material. (Optional)                                                                   | Material number identified on an M n card. Can be a dummy material or 0 (default). If the value is 0, use the cell material. (Optional)                                                                   |
| MTYPE = type   | Multiplier type (Optional). Acceptable character input values follow:                                                                                                                                     | Multiplier type (Optional). Acceptable character input values follow:                                                                                                                                     |
| MTYPE = type   | flux                                                                                                                                                                                                      | Normal volume flux calculations. Same interpretation as FMESH tally type = flux . (default)                                                                                                               |
| MTYPE = type   | isotopic                                                                                                                                                                                                  | Isotopic calculation. UM equivalent to the FMESH isotopic mesh tallies that require an + FM card.                                                                                                         |
| MTYPE = type   | population                                                                                                                                                                                                | Population calculation. Same as an F 4 tally with an FM card where k = - 2 in the multiplier set.                                                                                                         |
| MTYPE = type   | reaction                                                                                                                                                                                                  | Reaction calculation that requires the LIST parameter. This MTYPE with the LIST parameters is equivalent to an FMESH tally with a single multiplier set specified and its accompanying FM card.           |
| MTYPE = type   | source                                                                                                                                                                                                    | Accumulate source point locations. Same interpretation as FMESH tally type = source .                                                                                                                     |
| MTYPE = type   | tracks                                                                                                                                                                                                    | Tracks calculation. Same as an F4 tally with an FM card where k = - 1 in the multiplier set.                                                                                                              |

## 5.5.6.8 EMBEB: Embedded Elemental Edit Energy Bin Boundaries

| Data-card Form: EMBEB n e1 e2 . . . eK   | Data-card Form: EMBEB n e1 e2 . . . eK                                                                                                                                    |
|------------------------------------------|---------------------------------------------------------------------------------------------------------------------------------------------------------------------------|
| n                                        | The elemental edit number from EMBEE card; n = 0 is not valid                                                                                                             |
| ek                                       | Upper energy (MeV) of the k th bin. List must be monotonically increasing. (DEFAULT: One energy bin with boundary set to the maximum energy limit for the particle type.) |

## 5.5.6.9 EMBEM: Embedded Elemental Edit Energy Bin Multipliers

| Data-card Form: EMBEM n m1 m2 . . . mK   | Data-card Form: EMBEM n m1 m2 . . . mK                        |
|------------------------------------------|---------------------------------------------------------------|
| n                                        | The elemental edit number from EMBEE card; n = 0 is not valid |
| mk                                       | Multiplier for the k th energy bin. (DEFAULT: mk = 1 )        |

## 5.5.6.10 EMBTB: Embedded Elemental Edit Time Bin Boundaries

| Data-card Form: EMBTB n t1 t2 . . . tK   | Data-card Form: EMBTB n t1 t2 . . . tK                                                                                                                                                                    |
|------------------------------------------|-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|
| n                                        | The elemental edit number from EMBEE card; n = 0 is not valid                                                                                                                                             |
| tk                                       | Upper time (in shakes, where 1 shake = 10 - 8 s) for the t th time bin. List must be monotonically increasing. (DEFAULT: One time bin with boundary set to the maximum time limit for the particle type.) |

## 5.5.6.11 EMBTM: Embedded Elemental Edits Time Bin Multipliers

```
Data-card Form: EMBTM n m1 m2 . . . mK n The elemental edit number from EMBEE card; n = 0 is not valid mk Multiplier for the k th time bin. (DEFAULT: mk = 1 )
```

## 5.5.6.12 EMBDE: Embedded Elemental Edit Dose Energy Bin Boundaries

To avoid confusion and maintain the separability of edits from tallies,
separate response-function-specification cards are available to
implement response functions on UM edits. These are similar to the
standard DE / DF cards, but there are no built in functions associated
with these cards at this time.

| Data-card Form: EMBDE n e1 e2 . . . eK   | Data-card Form: EMBDE n e1 e2 . . . eK                                                                                                                                            |
|------------------------------------------|-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|
| n                                        | The elemental edit number from EMBEE card; n = 0 is not valid                                                                                                                     |
| ek                                       | Upper energy (MeV) for the k th energy bin. List must be monotonically increasing. (DEFAULT: one energy bin with boundary set to the maximum energy limit for the particle type.) |

## 5.5.6.13 EMBDF: Embedded Elemental Edits Dose Function Bin Multipliers

1

2

3

4

5

6

7

8

9

10

11

12

13

14

15

```
Data-card Form: EMBDF n m1 m2 . . . mK n The elemental edit number from EMBEE card; n = 0 is not valid mk Multiplier for the k th energy bin. (DEFAULT: mk = 1 )
```

## 5.5.6.13.1 Example 1

A LNK3DNT file can be generated with the MCNP input file in Listing 5.17
and then used by the MCNP input file in Listing 5.18.

```
1 Generate LNK3DNT file 2 1 1 -18.7 -1 imp:n=1 3 2 0 1 imp:n=0 4 5 1 rpp -10 10 -10 10 -10 10 6 7 kcode 5000 1.0 50 250 8 ksrc -5.0 0.0 0.0 5.0 0.0 0.0 9 0.0 -5.0 0.0 0.0 5.0 0.0 10 0.0 0.0 -5.0 0.0 0.0 5.0 11 totnu no 12 m1 92235.69c 1.0 13 dm1 92235 92235.50 14 prdmp j 275 15 mesh geom=xyz ref=0.0 -0.0 -0.0 origin=-10.0 -10.0 -10.0 16 imesh=10 iints=3 17 jmesh=10 jints=4 18 kmesh=10 kints=5 19 dawwg points=10 20 block=1 ngroup=16 isn=16 iquad=4 21 block=3 libname=mendf5 lib=ndilib 22 block=5 trcor=diag srcacc=dsa diffsol=mg isct=2 23 block=6 massed=1 edoutf=3 24 rand gen=2 seed=12345 25 print
```

Listing 5.17: example\_structured\_mesh\_generate\_1.mcnp.inp.txt

```
Read LNK3DNT file 11 1 -18.7 0 u=e10 imp:n=1 12 0 0 u=e10 imp:n=1 $ background 20 0 -1 fill=e10 imp:n=1 c 21 0 1 imp:n=0 1 s 0.0 0.0 0.0 15 kcode 5000 1.0 50 250 ksrc -5.1 0.1 0.1 5.1 0.1 0.1 0.1 -5.1 0.1 0.1 5.1 0.1 0.1 0.1 -5.1 0.1 0.1 5.1 totnu no m1 92235.69c 1.0
```

Listing 5.18: example\_structured\_mesh\_read\_1.mcnp.inp.txt