---
title: "Appendix D.6 - Unstructured Mesh File Format HDF5"
chapter: "D.6"
source_pdf: "mcnp631_theory_user-manual/appendecies/D.6_Unstructured_Mesh_File_Format_HDF5.pdf"
conversion_date: "2025-10-30"
converted_by: "Docling MCP Server + Claude"
notes: "Converted from MCNP6.3.1 documentation"
---

## D.6 Unstructured Mesh File Format: HDF5

## D.6.1 Introduction

The Hierarchical Data Format version 5 (HDF5) is an open source file
format [340]. An MCNP UM model geometry is derived from parts that are
positioned relative to one another to form an assembly and an HDF5 UM
model is designed by grouping the assembly into pseudo-cells (see §8.2
for a pseudo-cell definition). The HDF5 data model is chosen to store a
UM geometry and elemental edit outputs since (i) an HDF5 file is
designed to manage large complex data collections, (ii) an HDF5 file is
portable among different computing platforms, and (iii) an HDF5 file is
easy to view, edit, and analyze using public available software tools or
Python scripts.

An HDF5 file is a container for an organized collection of objects where
each object must have a unique identity within an HDF5 file and can be
accessed only by its name within the hierarchy of the file. HDF5 group,
dataset, and attribute objects are used to manage MCNP model data. In
each HDF5 file, the objects are organized similar to a directory and
file structure. A group and dataset are respectively comparable to a
directory and file where a group may contain groups and datasets. An
attribute is a named data value associated with a group or dataset.

Each HDF5 UM file contains up to three groups at the root level: config
\_ control , problem \_ info , and unstructured \_ mesh .

The presence of the config \_ control group is required in order to
process the HDF5 UM as an input mesh model. Both the kind \_ file ,
defined as 'um\_model', and version \_ file , defined as '[1,0,2]' for the
MCNP code version 6.3.0 and 6.3.1, attributes of the config \_ control
group are required to process the HDF5 UM file as input. When the
hdf5file keyword on the EMBED data card is specified, the resulting HDF5
UM file is written with a config \_ control group with all appropriate
attributes such that this file can be used as input in a subsequent
calculation. See §D.2.2 for more information on the contents of this
group that the MCNP code writes into the HDF5 UM file. If other codes
are used to create HDF5 UM input files for MCNP UM simulations, then the
kind \_ file and version \_ file attributes of the config \_ control group
must be written into the mesh input files.

The problem \_ info group is generated by the MCNP code within the
requested file specified using the hdf5file keyword on the EMBED data
card. See §D.2.5 for more information on the contents of this group. The
problem \_ info group is optional when other codes are used to generate
the HDF5 UM input files.

The unstructured \_ mesh group, which is required, contains six
attributes, one dataset, and one or more cell groups where the number of
cell groups depends on the model. The HDF5 objects in the unstructured \_
mesh group are summarized in Table D.14. The number \_ of \_ histories
attribute is not required in an HDF5 input model. The model \_
description attribute is a string describing the mesh model and its
length is 128 UTF-8 characters. The cell \_ name dataset is a 1D string
array whose size is equal to the total \_ cells attribute. Each entry
value in the cell \_ name array must be distinct and its length is 128
ASCII characters. The number of &lt;unique \_ cell \_ name&gt; groups must be
equal to the size of the cell \_ name array and each &lt;unique \_ cell \_
name&gt; group must be an entry of the cell \_ name array. The mesh model is
built from part data where some parts are used multiple times or divided
into multiple cells. The attributes related to total cell/part data
identify how the parts are used in the mesh model.

- For a model where parts are divided into multiple cells and each part is used only once, the total cells is greater than the total parts but the total cell elements is equal to the total part elements.
- For a model where a whole part is used in multiple cells, the total cells is greater than the total parts and the total cell elements is greater than the total part elements.

Table D.14: HDF5 Attributes/Dataset/Groups in unstructured \_ mesh Group.

| Name                                                                                                                                                | HDF5 Object                                                               | Data type                                                                          | Description                                                                                                                                                                                                                                     |
|-----------------------------------------------------------------------------------------------------------------------------------------------------|---------------------------------------------------------------------------|------------------------------------------------------------------------------------|-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|
| model _ description total _ cells total _ elements total _ parts total _ part _ elements number _ of _ histories cell _ name <unique _ cell _ name> | attribute attribute attribute attribute attribute attribute dataset group | string integer integer integer integer integer 1D string array attributes & groups | model description total cells in a model total elements of all cells total parts in a model total elements of all parts number of particle histories run unique name associated to cell group group containing cell geometries and edit outputs |

Table D.15: HDF5 Attributes/Groups in &lt;unique \_ cell \_ name&gt; Group.

| Path                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       | HDF5 Object                                                         | Data Type                                                                                                              |
|------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|---------------------------------------------------------------------|------------------------------------------------------------------------------------------------------------------------|
| / unstructured _ mesh / <unique _ cell _ name> / part _ name / unstructured _ mesh / <unique _ cell _ name> / cell _ id / unstructured _ mesh / <unique _ cell _ name> / number _ of _ nodes / unstructured _ mesh / <unique _ cell _ name> / number _ of _ elements / unstructured _ mesh / <unique _ cell _ name> / mesh / unstructured _ mesh / <unique _ cell _ name> / volume / unstructured _ mesh / <unique _ cell _ name> / material / unstructured _ mesh / <unique _ cell _ name> / source / unstructured _ mesh / <unique _ cell _ name> / edit | attribute dataset attribute attribute group group group group group | 128 UTF-8 characters integer integer 1D integer array datasets attribute & dataset datasets attribute & dataset groups |

- For a model where each whole part is used only once, the total cells is equal to the total parts and the total cell elements is equal to the total part elements.

## D.6.2 Cell Group

Each / unstructured \_ mesh / &lt;unique \_ cell \_ name&gt; group contains three
attributes and four groups listed in Table D.15 The HDF5 input model
requires only the part \_ name , number \_ of \_ nodes , number \_ of \_
elements attributes and the mesh , material , and source groups. The
following describes the HDF5 attributes in each &lt;unique \_ cell \_ name&gt;
group.

- The part \_ name attribute is the part name where the mesh data are extracted. The length of the part \_ name attribute is 128 UTF-8 characters.
- The cell \_ id dataset is a length-1 integer array that provides the MCNP (pseudo)cell identification number specified by the user in the MCNP input file. This field is present in MCNP UM HDF5 output files and is ignored in MCNP UM HDF5 input files.
- The number \_ of \_ nodes attribute is the number of nodes in a cell. The number \_ of \_ nodes must be greater than four.
- The number \_ of \_ elements attribute is the number of elements for each element type. Its size is six. Each entry in the number \_ of \_ elements array must be non-negative and the total number of elements must be positive. Since only linear pentahedron and hexahedron elements or quadratic pentahedron and hexahedron elements can be mixed in a part, the UM library will throw a fatal error if a cell contains other mixed element types. An entry of the number \_ of \_ elements array represents the number of elements based on the element type:

Table D.16: HDF5 Datasets in mesh Group.

| Path                                                                                                                                                                                                                                                                                    | Data Type                                                        |                                     |
|-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|------------------------------------------------------------------|-------------------------------------|
| / unstructured _ mesh / <unique _ cell _ name> / mesh / node _ id / unstructured _ mesh / <unique _ cell _ name> / mesh / node _ point / unstructured _ mesh / <unique _ cell _ name> / mesh / element _ id / unstructured _ mesh / <unique _ cell _ name> / mesh / XDMF _ connectivity | 1D integer array 2D real array 1D integer array 1D integer array | optional required optional required |

- -The first and fourth entries are respectively the numbers of linear and quadratic tetrahedron elements.
- -The second and fifth entries are respectively the numbers of linear and quadratic pentahedron elements.
- -The third and sixth entries are respectively the numbers of linear and quadratic hexahedron elements.

## D.6.2.1 Mesh Group

The / unstructured \_ mesh / &lt;unique \_ cell \_ name&gt; / mesh group contains
four datasets describing the geometry and connectivity. The dataset
names and dimensions are listed in Table D.16.

- The node \_ id dataset contains the node identifiers used to form the elements. It is a 1D integer array whose size is equal to the number \_ of \_ nodes attribute. All entries of the node \_ id array must be unique and positive. The node \_ id dataset is an optional data object. It is only required if the node \_ id array does not consecutively start from one.
- The node \_ point dataset contain the ( x, y, z ) points describing the node locations. This 2D real array dimension is ( n, 3) where n is the number \_ of \_ nodes attribute. The first and second indices of the node \_ point array represent the node identifiers and ( x, y, z ) locations, respectively. The dimensions of x, y, z are in centimeters.
- The element \_ id dataset contains the element identifiers. This 1D integer array is only required if the the element \_ id array does not consecutively start from one. If this array is required, its size must be equal to the summation of the number \_ of \_ elements array and each entry value in the element \_ id dataset must be distinct and positive. For a cell with mixed element types, the element \_ id array stores the element identifiers based on the element types ordering in the number \_ of \_ elements attribute.
- The XDMF \_ connectivity dataset contains the element connectivity. The mixed UM XDMF model is used to store this dataset. XDMF stands for eXtensible Data Model and Format and more information on XDMF can be found at [325]. The XDMF \_ connectivity dataset is a 1D integer array whose size depends on the number \_ of \_ elements attribute. The mixed UM XDMF model is made of an element type and a list of node indices describing an element; note that an element is called a cell in the XDMF literature. The XDMF \_ connectivity is then organized as follows: XDMF element type, list of node indices in an element, XDMF element type, list of node indices in an element, . . . , and hence its size is equal to the summation of number of element type times number of nodes plus one. For example, if there is 10 linear pentahedra and 1000 linear hexahedra in a cell, then the length of XDMF \_ connectivity is equal to 9070. For a cell with mixed element type, the XDMF \_ connectivity array stores the element data based on the element types ordering in the number \_ of \_ elements attribute. This leads to the limitation that the XDMF element type must be prefixed for each element in a cell even if a cell has only single element type. The node indices used to form an element start from zero. The XDMF element type is an integer used to represent a physical element type:
- -6 and 38 are respectively for a linear and quadratic tetrahedron,

Table D.17: HDF5 Attribute and Dataset in volume Group.

| Path                                                                                                                                               | HDF5 Object       | Data Type          |
|----------------------------------------------------------------------------------------------------------------------------------------------------|-------------------|--------------------|
| / unstructured _ mesh / <unique _ cell _ name> / volume / cell _ volume / unstructured _ mesh / <unique _ cell _ name> / volume / element _ volume | attribute dataset | real 1D real array |

Table D.18: HDF5 Datasets in material Group.

| Path                                                                                                                                                 | HDF5 Object     | Data Type                      |
|------------------------------------------------------------------------------------------------------------------------------------------------------|-----------------|--------------------------------|
| / unstructured _ mesh / <unique _ cell _ name> / material / material _ id / unstructured _ mesh / <unique _ cell _ name> / material / mass _ density | dataset dataset | 1D integer array 1D real array |

- -8 and 40 are respectively for a linear and quadratic pentahedron,
- -9 and 48 are respectively for a linear and quadratic hexahedron.

## D.6.2.2 Volume Group

The unstructured \_ mesh / &lt;unique \_ cell \_ name&gt; / volume group contains
one attribute and one dataset describing the element volumes in units of
cm 3 . The volume object data are listed in Table D.17.

- The cell \_ volume attribute is the volume of the cell. It is the summation of the element \_ volume dataset.
- The element \_ volume attribute is the element volume. This 1D array size is equal to the summation of the number \_ of \_ elements attribute and it stores the value based on the element type ordering in the number \_ of \_ elements attribute. Each entry of this array must be positive.

## D.6.2.3 Material Group

The / unstructured \_ mesh / &lt;unique \_ cell \_ name&gt; / material group
contains two datasets describing the materials. The material object data
are listed in Table D.18. The material properties present in an HDF5
mesh input file are not used for MCNP calculations. The MCNP code uses
the material properties defined in the MCNP input file.

- The material \_ id dataset is the material identifier. This 1D array has only one entry and its value must be a positive integer number.
- The mass \_ density dataset is the material mass density in units of g/cm 3 . This 1D array has only one entry and its value must be a non-negative real number.

## D.6.2.4 Source Group

The / unstructured \_ mesh / &lt;unique \_ cell \_ name&gt; / source group
contains one attribute and one dataset describing the source elements.
The source group is optional and the source object data are listed in
Table D.19. The source group is present only for the UM model that has
source elements. If the source group is present in the cell, then the
number \_ of \_ source \_ elements attribute and the source \_ element \_
value dataset are required and each cell in the model must have the
source group.

Table D.19: HDF5 Attribute and Dataset in source Group.

| / unstructured _ mesh / <unique _ cell _ name> / source / path                 | HDF5 Object               | Data Type                                 |                            |
|--------------------------------------------------------------------------------|---------------------------|-------------------------------------------|----------------------------|
| number _ of _ source _ elements source _ element _ value source _ element _ id | attribute dataset dataset | integer 1D integer array 1D integer array | required required optional |

Table D.20: HDF5 value and error Datasets in edit Group. X is an edit
number in an MCNP input file, Y is a particle number (1 for neutron, 2
for photon, 3 for electron, and so on), Z is an energy bin index number
starting from one, and W is a time bin index number starting from one.
If several particles are requested in the same edit number, then all
particle numbers will be included in X where the particle numbers are
separated by '\_'. For example, edit \_ 14 \_ particle \_ 1 \_ 2 is a field
name for neutron and photon of the edit number 14.

| / unstructured _ mesh / <unique _ cell _ name> / edit path to value and error Datasets   | Data Type     |
|------------------------------------------------------------------------------------------|---------------|
| / edit _ X _ particle _ Y / value ( error )                                              | 1D real array |
| / edit _ X _ particle _ Y _ energy _ bin _ Z / value ( error )                           | 1D real array |
| / edit _ X _ particle _ Y _ time _ bin _ W / value ( error )                             | 1D real array |
| / edit _ X _ particle _ Y _ energy _ bin _ Z _ time _ bin _ W / value ( error )          | 1D real array |
| / edit _ X _ particle _ Y _ energy _ total _ time _ bin _ W / value ( error )            | 1D real array |
| / edit _ X _ particle _ Y _ energy _ bin _ Z _ time _ total / value ( error ) )          | 1D real array |
| / edit _ X _ particle _ Y _ energy _ total _ time _ total / value ( error                | 1D real array |

- The number \_ of \_ source \_ elements attribute is the number of source elements. It must be a non-negative integer. It is equal to zero in the cell if the UM model has at least one source element but there is no source element in this cell.
- The source \_ element \_ value dataset is the source element value. This 1D array size is equal to the summation of the number \_ of \_ elements attribute and it stores the value based on the element type ordering in the number \_ of \_ elements attribute. Each entry is equal to one for a source element and zero for an non-source element. The number of non-zero entries is equal to the number \_ of \_ source \_ elements attribute. A source \_ element \_ value dataset is written for all cells in the HDF5 file for the UM model with source elements, whether a cell has elements that contain source or not, to simplify post-processing and/or visualization operations.
- The source \_ element \_ id dataset is the source element identifier. This 1D integer array is only required if the source \_ element \_ id array does not consecutively start from one. If this array is required, its size must be equal to the number \_ of \_ source \_ elements attribute and each entry in the source \_ element \_ id dataset must be unique and positive.

## D.6.2.5 Edit Group

The / unstructured \_ mesh / &lt;unique \_ cell \_ name&gt; / edit group contains
several groups whose names are shown Table D.20. The value and error
datasets are 1D real arrays whose size is equal to the summation of the
number \_ of \_ elements attribute. The value and error array store the
data based on the element types ordering in the number \_ of \_ elements
attribute. In addition, the subgroups in the edit group may contain the
following attributes.

- comment
- edit \_ energy \_ multiplier and edit \_ time \_ multiplier

- bin \_ energy \_ upper and bin \_ energy \_ multiplier . These attributes are available if the energy domain is broken into bins.
- bin \_ time \_ upper and bin \_ time \_ multiplier . These attributes are available if the time domain is broken into bins.

## D.6.3 Datatype and Array Dimension in HDF5 EEOUT Files

The binary HDF5 files are theoretically portable among platforms and
easy to extract data from HDF5 files. The following must be considered
when dealing with HDF5 EEOUT files.

- The mesh \_ description attribute and cell \_ name dataset must be fixed-length strings since the HDF5 library used to by the UM library can only handle fixed-length strings.
- The node \_ point dataset is a 2D array whose dimension is described as the row-major order in this manual. If Fortran code is used to write (or read) an HDF5 EEOUT file, then its dimension must be reversed to the column-major order.