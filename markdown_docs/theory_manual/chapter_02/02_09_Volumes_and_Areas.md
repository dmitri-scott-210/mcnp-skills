---
title: "Chapter 2.9 - Volumes and Areas"
chapter: "2.9"
source_pdf: "mcnp631_theory_user-manual/mcnp-theory-manual-chapters/2_Geometry,_Data,_Physics,_and_Mathematics/2.9_Volumes_and_Areas.pdf"
conversion_date: "2025-10-30"
converted_by: "Docling MCP Server + Claude"
notes: "Converted from MCNP6.3.1 documentation"
---

confidence intervals. If concern persists, a problem could be run that
tallies the track-length estimator k eff using an F 4 : n or TMESH tally
and an FM card using the -6 and -7 reaction multipliers (see §6.4.3.1
for an example). In the most drastic cases, several independent
calculations can be made and the variance of the k eff values (and any
other tallies) could be computed from the individual values.

If a conservative (too large) k eff confidence interval is desired, the
results from the largest k eff occurring on the next cycle table can be
used. This situation could occur with a maximum probability of 1 / ( I t
-I c ) for highly positively correlated k eff values to 1 / ( I t -I c )
3 for no correlation.

Finally, keep in mind the discussion in §2.8.2.9. For large systems with
a dominance ratio close to one, the estimated standard deviations for
tallies could be much smaller than the true standard deviation. The
cycle-to-cycle correlations in the fission sources are not taken into
account, especially for any tallies that are not made over the entire
problem. The only way to obtain the correct statistical errors in this
situation is to run a series of independent problems using different
random number sequences and analyze the sampled tally results to
estimate the statistical uncertainties.

## 2.9 Volumes and Areas

The particle flux in Monte Carlo transport problems often is estimated
as the track length per unit volume or the number of particles crossing
a surface per unit area. Therefore, knowing the volumes and surface
areas [178] of the geometric regions in a Monte Carlo problem is
essential. Knowing volumes is useful in calculating the masses and
densities of cells and thus in calculating volumetric or mass heating.
Furthermore, calculation of the mass of a geometry is frequently a good
check on the accuracy of the geometry setup when the mass is known by
other means.

Calculating volumes and surface areas in modern Monte Carlo transport
codes is nontrivial. The MCNP code allows the construction of cells from
unions and/or intersections of regions defined by an arbitrary
combination of second-degree surfaces, toroidal fourth-degree surfaces,
or both. These surfaces can have different orientations or be segmented
for tallying purposes. The cells they form can even consist of several
disjoint subcells. Cells can be constructed from quadrilateral or
hexagonal lattices or can be embedded in repeated structures universes.
Although such generality greatly increases the flexibility of the MCNP
code, computing cell volumes and surface areas understandably requires
increasingly elaborate computational methods.

The MCNP code automatically calculates volumes and areas of polyhedral
cells and of cells or surfaces generated by surfaces of revolution about
any axis, even a skew axis. If a tally is segmented, the segment volumes
or areas are computed. For nonrotationally symmetric or nonpolyhedral
cells, a stochastic volume and surface area method that uses ray tracing
is available [§2.9.3].

## 2.9.1 Rotationally Symmetric Volumes and Areas

The procedure for computing volumes and surface areas of rotationally
symmetric bodies follows:

1. Determine the common axis of symmetry of the cell [178]. If there is none and if the cell is not a polyhedron, the MCNP code cannot compute the volume (except stochastically) and the area of each bounding surface cannot be computed on the side of the asymmetric cell.
2. Convert the bounding surfaces to q-form:

<!-- formula-not-decoded -->

where s is the axis of rotational symmetry in the r -s coordinate
system. All MCNP surfaces except tori are quadratic surfaces and
therefore can be put into q-form.

3. Determine all intersections of the bounding surfaces with each other in the r -s coordinate system. This procedure generally requires the solution of a quartic equation [43]. For spheres, ellipses, and tori, extra intersection points are added so that these surfaces are not infinite. The list of intersections are put in order of increasing s -coordinate. If no intersection is found, the surface is infinite; its volume and area on one side cannot be computed.
4. Integrate over each bounding surface segment between intersections:

<!-- formula-not-decoded -->

<!-- formula-not-decoded -->

for volumes and for surface areas.

A bounding surface segment lies between two intersections that bound the
cell of interest.

A numerical integration is required for the area of a toroidal surface;
all other integrals are directly solved by integration formulas. The
sense of a bounding surface to a cell determines the sign of V . The
area of each surface is determined cell-by-cell twice, once for each
side of the surface. An area will be calculated unless bounded on both
sides by asymmetric or infinite cells.

## 2.9.2 Polyhedron Volumes and Areas

A polyhedron is a body bounded only by planes that can have an arbitrary
orientation. The procedure for calculating the volumes and surface areas
of polyhedra is as follows:

1. For each facet side (planar surface), determine the intersections ( r i , s i ) of the other bounding planes in the r -s coordinate system. The r -s coordinate system is redefined for each facet to be an arbitrary coordinate system in the plane of the facet.
2. Determine the area of the facet:

<!-- formula-not-decoded -->

and the coordinates of its centroid, ( r c , s c ) :

<!-- formula-not-decoded -->

The sums are over all bounding edges of the facet where i and i +1 are
the ends of the bounding edge such that, in going from i to i +1 , the
facet is on the right side. As with rotationally symmetric cells, the
area of a surface is determined cell-by-cell twice, once for each side.
The area of a surface on one side is the sum over all facets on that
side.

<!-- formula-not-decoded -->

3. The volume of a polyhedron is computed by using an arbitrary reference plane. Prisms are projected from each facet normal to the reference plane, and the volume of each prism is V = d a cos θ where
2. d is the distance from reference plane to facet centroid;
3. a is the facet area; and
4. θ is the angle between the external normal of the facet and the positive normal of the reference plane.

The sum of the prism volumes is the polyhedron cell volume.

Figure 2.27: Visualization of the estimate of GLYPH&lt;1&gt; 2 0 exp( -x )d x using a rejection-sampling Monte Carlo method.

<!-- image -->

## 2.9.3 Stochastic Volume and Area Calculation

The MCNP code cannot calculate the volumes and areas of asymmetric, non-
polyhedral, or infinite cells. Also, in some cases, the volume and area
calculation can fail because of round-off errors. For these cases a
stochastic estimation is possible by ray tracing. The theory is
described here while the application is given in §5.5.1.1.

The basic idea is to use the Monte Carlo method to solve area and volume
integrals and leverage the MCNP code to apply the method.

Where the form of the surface flux and volume flux tallies are given in
Equation 2.175, the solution to the tallies (integrals) can be used to
calculate the unknown area or volume.

Consider a simple 1-D example: finding the solution to GLYPH&lt;1&gt; 2 0 exp(
-x )d x .

One way to calculate this solution is similar to the classic method of
calculating the value of π with a circle inscribed in a square. In this
method, two random numbers are selected for the sampled location in the
enveloping region, and a comparison is made to see if the location is
within the area under the curve of the function. The estimate of the
integral would then be the known area of the superimposed rectangle
multiplied by the number of positions that are under the curve divided
by the total samples. A visualization of this method, as well as the
convergence to the true value of GLYPH&lt;1&gt; 2 0 exp( -x )d x = 1 + sinh(2)
-cosh(2) ≈ 0 . 8646647 is shown in Figure 2.27. An immediate issue is
seen in Figure 2.28 which shows this method hunting for the true value
and displaying significant error until a substantial number of samples
have been taken (Figure 2.16).

A better method, using sampling on a single random variable, is to
sample a PDF over a domain of integration. For any given function, there
are a number of PDFs that can be defined to sample over. Again,
considering

Figure 2.28: Convergence of the rejection-sampling estimate of the variance of the mean of GLYPH&lt;1&gt; 2 0 exp( -x )d x .

<!-- image -->

Figure 2.29: Estimate of GLYPH&lt;1&gt; 2 0 exp( -x )d x with uniform sampling ( q ( x ) = 1 / 2 ) .

<!-- image -->

the integral GLYPH&lt;1&gt; 2 0 exp( -x )d x , the simplest sampling PDF over
the domain of integration is a uniform sampling over the domain

<!-- formula-not-decoded -->

This equation is piecewise to satisfy the condition that the integral of
the PDF is 1 from -∞ to ∞ .

The sampling CDF is then

<!-- formula-not-decoded -->

Then, inverting the CDF to obtain samples using a random number between
0 and 1 gives

<!-- formula-not-decoded -->

<!-- formula-not-decoded -->

The scoring moments are

This importance sampling preserves the expected value regardless of the
PDF selected. As shown in Figures 2.29 and 2.30, multiple functions can
be chosen to sample from directly. Some functions are better than
others, as shown by the convergence to the true value of the well-biased
PDF

<!-- formula-not-decoded -->

Figure 2.30: Estimate of GLYPH&lt;1&gt; 2 0 exp( -x )d x with good ( q ( x ) = 1 -x 2 ) biasing.

<!-- image -->