Example 6: Lattice Element Tally (Bracket Notation)

PURPOSE:
Demonstrate tallying in specific elements of a repeated structure using bracket notation for lattice indices.

GEOMETRY:
- 3×3 array of fuel pins (LAT=1 simple cubic lattice)
- Each pin: fuel pellet + cladding + coolant
- Uniform source across lattice
- Universe 1 = fuel pin unit cell

TALLY DETAILS:
- F4:N with bracket notation to specify lattice elements
- Format: (cell<universe[i j k])
  - cell = cell number in unit cell (10 = fuel)
  - universe = universe filling lattice (1)
  - [i j k] = lattice indices
- Three separate tally bins for corner, center, and opposite corner elements

BRACKET NOTATION SYNTAX:
- [i j k] = Single element at lattice position (i, j, k)
- [i1:i2 j1:j2 k1:k2] = Range of elements
- [i1 j1 k1, i2 j2 k2] = Multiple specific elements (comma-separated)
- U=# = All cells filled by universe # (shorthand)

LATTICE INDICES:
- FILL card defines lattice range: FILL=-1:1 -1:1 0:0
- This creates 3×3×1 lattice (9 elements total)
- Indices: [-1,-1,0], [-1,0,0], [-1,1,0], [0,-1,0], ...
- Selected elements:
  - [-1,-1,0] = Bottom-left corner
  - [0,0,0] = Center
  - [1,1,0] = Top-right corner

KEY LEARNING POINTS:
1. Bracket notation allows tallying in specific lattice elements
2. Avoids creating separate cells for each element
3. Can tally ranges: [0:2 0:2 0:0] = all 9 elements in one tally
4. Lattice chains: (10<1[i j k]<20<30) for nested lattices
5. SD card with brackets specifies volumes for repeated structure tallies

REPEATED STRUCTURES CONCEPTS:
- LAT=1: Simple cubic lattice
- LAT=2: Hexagonal prism lattice
- Universe (U=) defines what fills each lattice position
- FILL card defines lattice indices and what fills each position

EXPECTED OUTPUT:
- Three tally bins showing flux in three specific fuel pins
- May see asymmetry due to source position and boundary effects
- Center pin typically has different flux than corner pins
- Useful for power distribution in reactor cores

ADVANCED FEATURES:
- Multiple ranges: F4:N (10<1[0:2 0:2 0:0]) gives 9 bins (all pins)
- SD card for volumes: SD4 (1.0 9r) if 9 elements specified
- Lattice tally chains: (c1<u1[i j k]<c2<u2) for hierarchical lattices
- SPDTL card: Performance optimization for large lattice tallies

VARIATIONS TO TRY:
- Tally all 9 elements: [- 1:1 -1:1 0:0]
- Add energy bins: E4 0.01 1 10
- Tally different cells: coolant (12) instead of fuel (10)
- Larger lattice: 5×5 or 7×7 array
- Axial variation: FILL=-1:1 -1:1 0:5 for 3×3×6 lattice
